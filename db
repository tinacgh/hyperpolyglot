<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html;charset=UTF-8"/>
<link rel="icon" type="image/gif" href="/favicon.gif"/>
<link rel="apple-touch-icon" sizes="120x120" href="touch-icon-iphone-retina.png" />
<link rel="apple-touch-icon" sizes="152x152" href="touch-icon-ipad-retina.png" />
<title>Databases: PostgreSQL, MySQL, SQLite, Redis, MongoDB, Neo4j - Hyperpolyglot</title>
<style type="text/css" id="internal-style">
@import url(hyperpolyglot.css);
</style>
<meta http-equiv="content-type" content="text/html;charset=UTF-8"/>
<meta http-equiv="content-language" content="en"/>
</head>
<body>
<div id="container-wrap-wrap">
  <div id="container-wrap">
    <div id="container">
      <div id="header">
        <h1><a href="/"><span>Hyperpolyglot</span></a></h1>
      </div>
      <div id="content-wrap">
        <div id="main-content">
<div id="page-title">
                            Databases: PostgreSQL, MySQL, SQLite, Redis, MongoDB, Neo4j
                        </div>
<div id="page-content">
                        

<p><strong>data models:</strong> <a href="#correspondence">correspondence</a></p>
<p><strong>databases:</strong> <a href="#arch">architecture</a> | <a href="#client">client</a> | <a href="#select">select</a> | <a href="#where">where</a> | <a href="#join">join</a> | <a href="#aggregate">aggregate</a> | <a href="#sort-limit">sort and limit</a> | <a href="#insert-update-delete">insert, update, and delete</a> | <a href="#schema">schema</a> | <a href="#sequences">sequences</a> | <a href="#indices">indices</a> | <a href="#import-export">import and export</a> | <a href="#script">script</a> | <a href="#func">function</a> | <a href="#query-tuning">query tuning</a> | <a href="#user">user</a> | <a href="#python">python</a> | <a href="#ruby">ruby</a> | <a href="#help">help</a> | <a href="#admin">admin</a></p>
<p><strong>sql:</strong> <a href="#types">types</a> | <a href="#casts">casts</a> | <a href="#literals">literals</a> | <a href="#dates">dates</a> | <a href="#identifiers">identifiers</a> | <a href="#op">operators</a> | <a href="#func">functions</a> | <a href="#distinct">distinct</a> | <a href="#qualified-asterisk">qualified *</a> | <a href="#regex">regular expressions</a> | <a href="#sequences">sequences</a> | <a href="#group-by">group by</a> | <a href="#aggregation-func">aggregation functions</a> | <a href="#window-func">window functions</a> | <a href="#where-subquery">where clause subqueries</a> | <a href="#join">join</a> | <a href="#from-subquery">from clause subquery</a> | <a href="#as">as</a> | <a href="#limit-offset">limit and offset</a> | <a href="#with">with</a> | <a href="#null">null</a> | <a href="#set-multiset">sets and multisets</a> | <a href="#session-obj">session objects</a> | <a href="#scripts">scripts</a> | <a href="#reflection">reflection</a> | <a href="#sargable-expr">sargable expressions</a> | <a href="#txn">transactions</a> | <a href="#idempotent">idempotent sql</a></p>
<table class="wiki-content-table"><tr><th></th>
<th><a href="#postgresql">postgresql</a></th>
<th><a href="#mysql">mysql</a></th>
<th><a href="#sqlite">sqlite</a></th>
<th><a href="#redis">redis</a></th>
<th><a href="#mongodb">mongodb</a></th>
<th><a href="#neo4j">neo4j</a></th>
</tr><tr><td><a name="version-used" id="version-used"></a><a href="#version-used-note">version used</a></td>
<td><span style="color: gray"><em>9.1</em></span></td>
<td><span style="color: gray"><em>MariaDB 5.5 with InnoDB</em></span></td>
<td><span style="color: gray"><em>3.7</em></span></td>
<td><span style="color: gray"><em>2.6</em></span></td>
<td><span style="color: gray"><em>2.0</em></span></td>
<td><span style="color: gray"><em>2.0</em></span></td>
</tr><tr><td><a name="show-version" id="show-version"></a><a href="#show-version-note">show version</a></td>
<td><span style="color: gray"><em>client:</em></span><br />
$ psql <span style="white-space: pre-wrap;">--</span>version<br /><br /><span style="color: gray"><em>server:</em></span><br /><span style="white-space: pre-wrap;">&gt;</span> show server_version;</td>
<td><span style="color: gray"><em>client:</em></span><br />
$ mysql <span style="white-space: pre-wrap;">--</span>version<br /><br /><span style="color: gray"><em>server:</em></span><br /><span style="white-space: pre-wrap;">&gt;</span> status;</td>
<td>$ sqlite3 <span style="white-space: pre-wrap;">--</span>version</td>
<td><span style="color: gray"><em>client:</em></span><br />
$ redis-cli <span style="white-space: pre-wrap;">--</span>version<br /><br /><span style="color: gray"><em>server:</em></span><br /><span style="white-space: pre-wrap;">&gt;</span> info server</td>
<td><span style="color: gray"><em>client:</em></span><br />
$ mongo <span style="white-space: pre-wrap;">--</span>version<br /><br /><span style="color: gray"><em>server:</em></span><br /><span style="white-space: pre-wrap;">&gt;</span> db.version()</td>
<td>$ neo4j info</td>
</tr><tr><th colspan="7"><a name="arch" id="arch"></a><a href="#arch-note">architecture</a></th>
</tr><tr><td><a name="engine-arch" id="engine-arch"></a><a href="#engine-arch-note">engine</a></td>
<td><span style="color: gray"><em>in separate server process which communicates with client via TCP port or Unix domain socket</em></span></td>
<td><span style="color: gray"><em>in separate server process which communicates with client via TCP port or Unix domain socket</em></span></td>
<td><span style="color: gray"><em>contained in client library</em></span></td>
<td><span style="color: gray"><em>in separate server process which communicates with client via TCP port</em></span></td>
<td><span style="color: gray"><em>in separate server process which communicates with client via TCP port</em></span></td>
<td><span style="color: gray"><em>in separate server process which communicates with client via TCP port</em></span></td>
</tr><tr><td><a name="data-arch" id="data-arch"></a><a href="#data-arch-note">data</a></td>
<td><span style="color: gray"><em>database consists of tables which represent relations</em></span></td>
<td><span style="color: gray"><em>database consists of tables which represent relations</em></span></td>
<td><span style="color: gray"><em>database consists of tables which represent relations</em></span></td>
<td><span style="color: gray"><em>database is a key-value store; keys are strings; values can be strings, lists, sets, or hashes</em></span></td>
<td><span style="color: gray"><em>database consists of collections of "augmented JSON" documents</em></span></td>
<td><span style="color: gray"><em>database consists of nodes which are connected by relationships; each node and relationship has a key-value store called its properties; the values can be Java primitive types or homogeneous arrays</em></span></td>
</tr><tr><td><a name="files-arch" id="files-arch"></a><a href="#files-arch-note">files</a></td>
<td><span style="color: gray"><em>each table corresponds to one or more files on the file system</em></span></td>
<td></td>
<td><span style="color: gray"><em>database is stored in a single file</em></span></td>
<td><span style="color: gray"><em>the entire key-value store must fit into memory</em></span></td>
<td></td>
<td><span style="color: gray"><em>separate files for nodes, properties, and relationships</em></span></td>
</tr><tr><td><a name="persistence-arch" id="persistence-arch"></a><a href="#persistence-arch-note">persistence</a></td>
<td><span style="color: gray"><em>a write ahead log is used to ensure durability without flushing tables to disk after each transaction</em></span></td>
<td><span style="color: gray"><em>depends on storage engine; in InnoDB a redo log is used to ensure durability without flushing tables to disk after each transaction</em></span></td>
<td><span style="color: gray"><em>database file is updated after each transaction</em></span></td>
<td><span style="color: gray"><em>can be configured to (1) log every write operation to an AOF file, (2) periodically snapshot the key-value store to an RDB file, (3) not persist data at all</em></span></td>
<td><span style="color: gray"><em>a journal is used to ensure durability without flushing to disk after each save; the journal is flushed every 100ms</em></span></td>
<td><span style="color: gray"><em>database writes to logical logs after each commit</em></span></td>
</tr><tr><td><a name="indices-arch" id="indices-arch"></a><a href="#indices-arch-note">indices</a></td>
<td><span style="color: gray"><em>tables can have any number of indices</em></span></td>
<td><span style="color: gray"><em>tables can have any number of indices</em></span></td>
<td><span style="color: gray"><em>tables can have any number of indices</em></span></td>
<td><span style="color: gray"><em>hash values can be used as secondary indices</em></span></td>
<td><span style="color: gray"><em>collections can have any number of indices</em></span></td>
<td></td>
</tr><tr><td><a name="txn-arch" id="txn-arch"></a><a href="#txn-arch-note">transactions</a></td>
<td><span style="color: gray"><em>transactions can contain DML and DDL; row and table locking is available</em></span></td>
<td><span style="color: gray"><em>transactions can contain DML; table locking is available; InnoDB storage engine uses row locking to implement transactions</em></span></td>
<td></td>
<td></td>
<td></td>
<td><span style="color: gray"><em>transactions can contain DML</em></span></td>
</tr><tr><td><a name="security-arch" id="security-arch"></a><a href="#security-arch-note">security</a></td>
<td><span style="color: gray"><em>password protected user accounts with fine grained permissions</em></span></td>
<td></td>
<td></td>
<td><span style="color: gray"><em>optional password challenge to connect</em></span></td>
<td></td>
<td></td>
</tr><tr><td><a name="server-lang-arch" id="server-lang-arch"></a><a href="#server-lang-arch-note">server side language</a></td>
<td><span style="color: gray"><em>PL/pgSQL; server can be extended to support other languages</em></span></td>
<td><span style="color: gray"><em>SQL/PSM</em></span></td>
<td><span style="color: gray"><em>none</em></span></td>
<td><span style="color: gray"><em>Lua in Redis 2.6</em></span></td>
<td><span style="color: gray"><em>JavaScript</em></span></td>
<td><span style="color: gray"><em>Groovy or Jython</em></span></td>
</tr><tr><th colspan="7"><a name="client" id="client"></a><a href="#client-note">client</a></th>
</tr><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
<th>redis</th>
<th>mongodb</th>
<th>neo4j</th>
</tr><tr><td><a name="invoke-client" id="invoke-client"></a><a href="#invoke-client-note">invoke client</a></td>
<td>$ psql -U $USER -h localhost</td>
<td>$ mysql -u $USER -h localhost -p</td>
<td>$ sqlite3 DB_FILE</td>
<td>$ redis-cli</td>
<td>$ mongo</td>
<td>$ neo4j-shell</td>
</tr><tr><td><a name="client-help" id="client-help"></a><a href="#client-help-note">client help</a></td>
<td>\?</td>
<td>?<br />
\?<br />
\h<br />
help</td>
<td>.help</td>
<td>help</td>
<td>help</td>
<td>help</td>
</tr><tr><td><a name="default-port" id="default-port"></a><a href="#default-port-note">default port</a></td>
<td><span style="color: gray"><em>5432</em></span></td>
<td><span style="color: gray"><em>3306</em></span></td>
<td><span style="color: gray"><em>none</em></span></td>
<td><span style="color: gray"><em>6379</em></span></td>
<td><span style="color: gray"><em>27017</em></span></td>
<td><span style="color: gray"><em>7474</em></span></td>
</tr><tr><td><a name="show-db" id="show-db"></a><a href="#show-db-note">show databases</a></td>
<td>select datname<br />
from pg_database;<br /><br />
\l</td>
<td>show databases;</td>
<td>.databases</td>
<td><span style="color: gray"><em>redis databases are numbered from zero:</em></span><br />
config get databases</td>
<td>show dbs</td>
<td><span style="color: gray"><em>neo4j servers have only one graph</em></span></td>
</tr><tr><td><a name="switch-db" id="switch-db"></a><a href="#switch-db-note">switch database</a></td>
<td>\connect <span style="color: gray"><em>database</em></span>;</td>
<td>use <span style="color: gray"><em>database</em></span></td>
<td></td>
<td>select <span style="color: gray"><em>database_number</em></span></td>
<td>use <span style="color: gray"><em>database</em></span></td>
<td></td>
</tr><tr><td><a name="current-db" id="current-db"></a><a href="#current-db-note">current database</a></td>
<td>select current_database();</td>
<td>select DATABASE();</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td><a name="chdir" id="chdir"></a><a href="#chdir-note">chdir</a></td>
<td>\cd /tmp</td>
<td></td>
<td></td>
<td></td>
<td><span style="color: gray"><em>none</em></span></td>
<td></td>
</tr><tr><td><a name="shell-cmd" id="shell-cmd"></a><a href="#shell-cmd-note">shell command</a></td>
<td>\! ls</td>
<td>system ls</td>
<td></td>
<td></td>
<td><span style="color: gray"><em>none; but there is a</em> ls() <em>function</em></span></td>
<td></td>
</tr><tr><td><a name="client-startup-file" id="client-startup-file"></a><a href="#client-startup-file-note">client startup file</a></td>
<td>~/.psqlrc</td>
<td></td>
<td>~/.sqliterc</td>
<td></td>
<td></td>
<td></td>
</tr><tr><td><a name="custom-prompt" id="custom-prompt"></a><a href="#custom-prompt-note">custom prompt</a></td>
<td>\set PROMPT1 '%n@%/ &gt; '</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th colspan="7"><a name="select" id="select"></a><a href="#select-note">select</a></th>
</tr><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
<th>redis</th>
<th>mongodb</th>
<th>neo4j</th>
</tr><tr><td>select *</td>
<td>select *<br />
from baz;</td>
<td>select *<br />
from baz;</td>
<td>select *<br />
from baz;</td>
<td></td>
<td><span style="color: gray"><em>type "it" to page thru results:</em></span><br />
db.baz.find();</td>
<td>start n=node(*) return n;</td>
</tr><tr><td>project</td>
<td>select bar<br />
from baz;</td>
<td>select bar<br />
from baz;</td>
<td>select bar<br />
from baz;</td>
<td></td>
<td>db.baz.find({}, {"bar": 1})</td>
<td></td>
</tr><tr><td>where</td>
<td>select *<br />
from baz<br />
where foo = "bar";</td>
<td>select *<br />
from baz<br />
where foo = "bar";</td>
<td>select *<br />
from baz<br />
where foo = "bar";</td>
<td><span style="color: gray"><em>database as document:</em></span><br />
get bar<br />
get baz<br /><br /><span style="color: gray"><em>value as document:</em></span><br />
hgetall <span style="color: gray"><em>key</em></span></td>
<td>db.baz.find({"foo":"bar"});<br /><br /><span style="color: gray"><em>selects</em> {"foo": {"quux": "bar"}}:</span><br />
db.baz.find({"foo.quux": "bar"})</td>
<td></td>
</tr><tr><td>single row</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>var data = db.baz.findOne({"foo": "bar"});</td>
<td></td>
</tr><tr><td>limit</td>
<td>select *<br />
from baz<br />
limit 10;</td>
<td>select *<br />
from baz<br />
limit 10;</td>
<td>select *<br />
from baz<br />
limit 10;</td>
<td></td>
<td>db.baz.find().limit(10);</td>
<td></td>
</tr><tr><td>current timestamp</td>
<td>select now();<br />
select current_timestamp;</td>
<td>select now();<br />
select current_timestamp;</td>
<td>select current_timestamp;</td>
<td><span style="color: gray"><em>unix timestamp:</em></span><br />
time</td>
<td>new Date()</td>
<td></td>
</tr><tr><th colspan="7"><a name="where" id="where"></a><a href="#where-note">where</a></th>
</tr><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
<th>redis</th>
<th>mongodb</th>
<th>neo4j</th>
</tr><tr><td>comparison operators</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>db.baz.find({"foo": {$gt: 15}})<br />
db.baz.find({"foo": {$lt: 15}})<br />
db.baz.find({"foo": {$gte: 15}})<br />
db.baz.find({"foo": {$lte: 15}})<br />
db.baz.find({"foo": {$ne: 15}})</td>
<td></td>
</tr><tr><td>has key</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>db.baz.find({"foo": {$exists: true}})</td>
<td></td>
</tr><tr><td>multiple conditions on field</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>membership</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>db.scores.find({a: {'$in': [2, 3, 4]}});</td>
<td></td>
</tr><tr><th colspan="7"><a name="join" id="join"></a><a href="#join-note">join</a></th>
</tr><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
<th>redis</th>
<th>mongodb</th>
<th>neo4j</th>
</tr><tr><th colspan="7"><a name="aggregate" id="aggregate"></a><a href="#aggregate-note">aggregate</a></th>
</tr><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
<th>redis</th>
<th>mongodb</th>
<th>neo4j</th>
</tr><tr><td>row count</td>
<td>select count(*) from foo;</td>
<td>select count(*) from foo;</td>
<td>select count(*) from foo;</td>
<td></td>
<td>db.foo.count()</td>
<td></td>
</tr><tr><th colspan="7"><a name="sort-limit" id="sort-limit"></a><a href="#sort-limit-note">sort and limit</a></th>
</tr><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
<th>redis</th>
<th>mongodb</th>
<th>neo4j</th>
</tr><tr><td>ascending order</td>
<td>select *<br />
from baz<br />
order by foo;</td>
<td>select *<br />
from baz<br />
order by foo;</td>
<td>select *<br />
from baz<br />
order by foo;</td>
<td></td>
<td>db.baz.find().sort({"foo": 1)}</td>
<td></td>
</tr><tr><td>descending order</td>
<td>select *<br />
from baz<br />
order by foo desc;</td>
<td>select *<br />
from baz<br />
order by foo desc;</td>
<td>select *<br />
from baz<br />
order by foo desc;</td>
<td></td>
<td>db.baz.find().sort({"foo": -1)}</td>
<td></td>
</tr><tr><td>order by multiple columns</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th colspan="7"><a name="insert-update-delete" id="insert-update-delete"></a><a href="#insert-update-delete-note">insert, update, and delete</a></th>
</tr><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
<th>redis</th>
<th>mongodb</th>
<th>neo4j</th>
</tr><tr><td><a name="insert" id="insert"></a><a href="#insert-note">insert</a></td>
<td>insert into foo (bar, baz)<br />
values (1, 'one');</td>
<td>insert into foo (bar, baz)<br />
values (1, 'one');</td>
<td>insert into foo (bar, baz)<br />
values (1, 'one');</td>
<td><span style="color: gray"><em>database as document:</em></span><br />
set bar 1<br />
set baz "one"<br /><br /><span style="color: gray"><em>value as document:</em></span><br />
hset foo bar 1<br />
hset foo baz one</td>
<td>db.foo.save({<br /><span style="white-space: pre-wrap;">  </span>"bar": 1,<br /><span style="white-space: pre-wrap;">  </span>"baz": "one"<br />
});</td>
<td>create (n:Foo<br /><span style="white-space: pre-wrap;">  </span>{bar:1, baz:"one"});</td>
</tr><tr><td><a name="update" id="update"></a><a href="#update-note">update</a></td>
<td>update foo<br />
set baz = 'une'<br />
where bar = 1;</td>
<td>update foo<br />
set baz = 'une'<br />
where bar = 1;</td>
<td>update foo<br />
set baz = 'une'<br />
where bar = 1;</td>
<td><span style="color: gray"><em>database as document:</em></span><br />
set baz une<br /><br /><span style="color: gray"><em>value as document:</em></span><br />
hset foo baz une</td>
<td></td>
<td></td>
</tr><tr><td><a name="merge" id="merge"></a><a href="#merge-note">merge</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td><a name="delete" id="delete"></a><a href="#delete-note">delete</a></td>
<td>delete from foo<br />
where bar = 1;</td>
<td>delete from foo<br />
where bar = 1;</td>
<td>delete from foo<br />
where bar = 1;</td>
<td><span style="color: gray"><em>database as document:</em></span><br />
flushdb<br /><br /><span style="color: gray"><em>value as document:</em></span><br />
del foo</td>
<td>db.foo.remove({"bar": 1})</td>
<td></td>
</tr><tr><td><a name="delete-all-rows" id="delete-all-rows"></a><a href="#delete-all-rows-note">delete all rows</a></td>
<td>delete from foo;<br /><br /><span style="color: gray"><em>faster:</em></span><br />
truncate foo;</td>
<td>delete from foo;<br /><br /><span style="color: gray"><em>faster on 5.0.3 and later:</em></span><br />
truncate foo;</td>
<td>delete from foo;</td>
<td>flushdb</td>
<td>db.foo.remove()</td>
<td></td>
</tr><tr><th colspan="7"><a name="schema" id="schema"></a><a href="#schema-note">schema</a></th>
</tr><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
<th>redis</th>
<th>mongodb</th>
<th>neo4j</th>
</tr><tr><td><a name="create-table" id="create-table"></a><a href="#create-table-note">create table</a></td>
<td>create table foo (<br /><span style="white-space: pre-wrap;">  </span>bar int,<br /><span style="white-space: pre-wrap;">  </span>baz text<br />
);</td>
<td>create table foo (<br /><span style="white-space: pre-wrap;">  </span>bar int,<br /><span style="white-space: pre-wrap;">  </span>baz text<br />
);</td>
<td>create table foo (<br /><span style="white-space: pre-wrap;">  </span>bar int,<br /><span style="white-space: pre-wrap;">  </span>baz text<br />
);</td>
<td></td>
<td></td>
<td></td>
</tr><tr><td><a name="drop-table" id="drop-table"></a><a href="#drop-table-note">drop table</a></td>
<td>drop table foo;</td>
<td>drop table foo;</td>
<td>drop table foo;</td>
<td></td>
<td></td>
<td></td>
</tr><tr><td><a name="show-tables" id="show-tables"></a><a href="#show-tables-note">show tables</a></td>
<td>\d</td>
<td>show tables;</td>
<td>.tables</td>
<td></td>
<td>show collections</td>
<td></td>
</tr><tr><td><a name="describe-table" id="describe-table"></a><a href="#describe-table-note">describe table</a></td>
<td>\d <span style="color: gray"><em>table</em></span></td>
<td>desc <span style="color: gray"><em>table</em></span>;</td>
<td>.schema <span style="color: gray"><em>table</em></span></td>
<td><span style="color: gray"><em>none; database does not enforce a schema</em></span></td>
<td><span style="color: gray"><em>none; collections do not enforce a schema</em></span></td>
<td></td>
</tr><tr><td><a name="export-schema" id="export-schema"></a><a href="#export-schema-note">export schema</a></td>
<td>$ pg_dump -a <span style="color: gray"><em>db</em></span> &gt; <span style="color: gray"><em>db</em></span>.sql</td>
<td>$ mysqldump <span style="white-space: pre-wrap;">--</span>d <span style="color: gray"><em>db</em></span> &gt; <span style="color: gray"><em>db</em></span>.sql</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td><a name="describe-doc" id="describe-doc"></a><a href="#describe-doc-note">describe document</a></td>
<td><span style="color: gray"><em>table determines row type</em></span></td>
<td><span style="color: gray"><em>table determines row type</em></span></td>
<td></td>
<td><span style="color: gray"><em>database as document:</em></span><br />
keys *<br />
type bar<br />
type baz<br /><br /><span style="color: gray"><em>value as document:</em></span><br />
hkeys foo</td>
<td>var cur = db.foo.find()<br /><br />
var doc = cur.next()<br /><br />
Object.keys(doc)</td>
<td></td>
</tr><tr><th colspan="7"><a name="sequences" id="sequences"></a><a href="#sequences-note">sequences</a></th>
</tr><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
<th>redis</th>
<th>mongodb</th>
<th>neo4j</th>
</tr><tr><td><a name="incr" id="incr"></a><a href="#incr-note">increment</a></td>
<td></td>
<td></td>
<td></td>
<td>set foo 0<br />
incr foo</td>
<td></td>
<td></td>
</tr><tr><th colspan="7"><a name="indices" id="indices"></a><a href="#indices-note">indices</a></th>
</tr><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
<th>redis</th>
<th>mongodb</th>
<th>neo4j</th>
</tr><tr><td>show indices</td>
<td>\di</td>
<td>show index from <span style="color: gray"><em>table</em></span>;</td>
<td>.indices</td>
<td></td>
<td>db.foo.getIndexes();</td>
<td></td>
</tr><tr><td>create index</td>
<td>create index foo_bar_idx on foo (bar);</td>
<td><span style="color: gray"><em>InnoDB requires that the max length of a text or varchar column be less than 767 characters</em></span><br />
create index foo_bar_idx on foo (bar);</td>
<td>create index foo_bar_idx on foo ( bar );</td>
<td></td>
<td>db.foo.ensureIndex({"baz": 1})</td>
<td></td>
</tr><tr><td>drop index</td>
<td>drop index foo_bar_idx;</td>
<td>drop index foo_bar_idx on foo;</td>
<td>drop index foo_bar_idx;</td>
<td></td>
<td>db.foo.dropIndex({"baz": 1})</td>
<td></td>
</tr><tr><td>create unique index</td>
<td>create unique index foo_bar_idx on foo (bar);</td>
<td>create unique index foo_bar_idx on foo (bar);</td>
<td>create unique index foo_bar_idx on foo ( bar );</td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>create compound index</td>
<td>create index foo_bar_baz_idx on foo (bar, baz);</td>
<td>create index foo_bar_baz_idx on foo (bar, baz);</td>
<td>create index foo_bar_baz_idx on foo (bar, baz);</td>
<td></td>
<td></td>
<td></td>
</tr><tr><th colspan="7"><a name="import-export" id="import-export"></a><a href="#import-export-note">import and export</a></th>
</tr><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
<th>redis</th>
<th>mongodb</th>
<th>neo4j</th>
</tr><tr><td><a name="import-tab" id="import-tab"></a><a href="#import-tab-note">import tab delimited</a></td>
<td><span style="color: gray"><em>what about header</em></span><br /><br />
$ grep -v '^#' /etc/passwd | tr ':' '\t' &gt; /tmp/passwd.tab<br /><br />
$ echo 'create table etc_passwd ( name text, pw text, uid int, gid int, gecos text, home text, shell text );' | psql<br /><br />
$ ( echo 'copy etc_passwd from stdin;' ; cat /tmp/passwd.tab ) | psql</td>
<td></td>
<td>$ grep -v '^#' /etc/passwd | tr ':' '\t' &gt; /tmp/passwd.tab<br /><br />
$ sqlite3<br /><br /><span style="white-space: pre-wrap;">&gt;</span> create table etc_passwd ( name text, pw text, uid int, gid int, gecos text, home text, shell text );<br /><br /><span style="white-space: pre-wrap;">&gt;</span> .separator \t<br /><br /><span style="white-space: pre-wrap;">&gt;</span> .import /tmp/passwd.tab etc_passwd</td>
<td></td>
<td>$ grep -v '^#' /etc/passwd | tr ':' '\t' &gt; /tmp/passwd.tab<br /><br />
$ mongoimport -d test -c etc_passwd -f name,pw,uid,gid,gecos,home,shell <span style="white-space: pre-wrap;">--</span>type tsv &lt; /tmp/passwd.tab</td>
<td></td>
</tr><tr><td><a name="import-csv" id="import-csv"></a><a href="#import-csv-note">import csv</a></td>
<td>$ echo $'1,"one, two, three"\n2,four\n3,"five\nsix\nseven"' &gt; /tmp/test.csv<br /><br />
$ echo 'create table test_csv ( col1 int, col2 text );' | psql<br /><br />
$ ( echo 'copy test_csv from stdin with (format csv); '; cat /tmp/test.csv ) | psql</td>
<td></td>
<td>$ echo $'1,"one, two, three"\n2,four\n3,"five\nsix\nseven"' &gt; /tmp/test.csv<br /><br />
$ sqlite3<br /><br /><span style="white-space: pre-wrap;">&gt;</span> create table test_csv ( col1 int, col2 text );<br /><br /><span style="white-space: pre-wrap;">&gt;</span> .mode csv<br /><br /><span style="white-space: pre-wrap;">&gt;</span> .import /tmp/test.csv test_csv</td>
<td></td>
<td>$ echo $'1,"one, two, three"\n2,four\n3,"five\nsix\nseven"' &gt; /tmp/test.csv<br /><br />
$ mongoimport -d test -c test_csv <span style="white-space: pre-wrap;">--</span>type csv -f col1,col2 &lt; /tmp/test.csv</td>
<td></td>
</tr><tr><td><a name="import-json" id="import-json"></a><a href="#import-json-note">import json</a></td>
<td><span style="color: gray"><em>none</em></span></td>
<td></td>
<td><span style="color: gray"><em>none</em></span></td>
<td></td>
<td>$ mongoimport -d <span style="color: gray"><em>db</em></span> -c <span style="color: gray"><em>collection</em></span> &lt; /tmp/dump.json</td>
<td></td>
</tr><tr><td><a name="export-tab" id="export-tab"></a><a href="#export-tab-note">export tab delimited</a></td>
<td><span style="color: gray"><em>what about tabs or newlines in data</em></span><br /><br />
echo 'copy foo to stdout;' | psql &gt; /tmp/foo.tab<br /><br /><span style="color: gray"><em>how to export at psql prompt:</em></span><br />
\f '\t'<br />
\a<br />
\pset footer off<br />
\o foo.tab<br />
select * from foo;<br />
\o</td>
<td></td>
<td>.mode tabs<br />
.output /tmp/foo.tab<br />
select * from foo;</td>
<td></td>
<td><span style="color: gray"><em>none</em></span></td>
<td></td>
</tr><tr><td><a name="export-csv" id="export-csv"></a><a href="#export-csv-note">export csv</a></td>
<td>$ echo 'copy foo to stdout with (format csv);' | psql &gt; /tmp/foo.csv</td>
<td></td>
<td>.mode csv<br />
.output /tmp/foo.csv<br />
select * from foo;</td>
<td></td>
<td>$ mongoexport -d test -c test_csv -f name,pw,uid,gid,gecos,home,shell <span style="white-space: pre-wrap;">--</span>csv</td>
<td></td>
</tr><tr><td><a name="export-json" id="export-json"></a><a href="#export-json-note">export json</a></td>
<td><span style="color: gray"><em>none</em></span></td>
<td></td>
<td><span style="color: gray"><em>none</em></span></td>
<td></td>
<td>$ mongoexport -d <span style="color: gray"><em>db</em></span> -c <span style="color: gray"><em>collection</em></span> &gt; /tmp/dump.json</td>
<td></td>
</tr><tr><th colspan="7"><a name="script" id="script"></a><a href="#script-note">script</a></th>
</tr><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
<th>redis</th>
<th>mongodb</th>
<th>neo4j</th>
</tr><tr><td><a name="sql-script" id="sql-script"></a><a href="#sql-script-note">run script</a></td>
<td>\i foo.sql<br /><br />
$ psql -f foo.sql</td>
<td>source foo.sql<br /><br />
$ mysql <span style="color: gray"><em>db</em></span> &lt; foo.sql</td>
<td>.read foo.sql</td>
<td></td>
<td>load("foo.js");</td>
<td></td>
</tr><tr><th colspan="7"><a name="func" id="func"></a><a href="#func-note">function</a></th>
</tr><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
<th>redis</th>
<th>mongodb</th>
<th>neo4j</th>
</tr><tr><td><a name="show-func" id="show-func"></a><a href="#show-func-note">show functions</a></td>
<td>\df;</td>
<td>show function status;<br /><br />
show procedure status;<br /><br />
select routine_name<br />
from information_schema.routines;</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td><a name="show-func-src" id="show-func-src"></a><a href="#show-func-src-note">show function source</a></td>
<td>\df+ <span style="color: gray"><em>func_name</em></span>;</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>show built-in functions</td>
<td>select proname from pg_proc;<br /><br />
select routine_name<br />
from information_schema.routines;</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>define function</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th colspan="7"><a name="query-tuning" id="query-tuning"></a><a href="#query-tuning-note">query tuning</a></th>
</tr><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
<th>redis</th>
<th>mongodb</th>
<th>neo4j</th>
</tr><tr><td>explain plan</td>
<td>explain select * from foo;</td>
<td></td>
<td></td>
<td></td>
<td>var cur = db.foo.find();<br />
cur.explain();</td>
<td></td>
</tr><tr><td>query stats</td>
<td>explain analyze select * from foo;</td>
<td></td>
<td>.stats on<br />
.stats off</td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>timer</td>
<td></td>
<td></td>
<td>.timer on<br />
.time off</td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>stats tables</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th colspan="7"><a name="user" id="user"></a><a href="#user-note">user</a></th>
</tr><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
<th>redis</th>
<th>mongodb</th>
<th>neo4j</th>
</tr><tr><td><a name="current-user" id="current-user"></a><a href="#current-user-note">current user</a></td>
<td>select current_user;</td>
<td>select user();</td>
<td><span style="color: gray"><em>none</em></span></td>
<td><span style="color: gray"><em>none</em></span></td>
<td></td>
<td></td>
</tr><tr><td><a name="list-users" id="list-users"></a><a href="#list-users-note">list users</a></td>
<td>select usename<br />
from pg_user;</td>
<td><span style="color: gray"><em>table only readable by root:</em></span><br />
select user from mysql.user;</td>
<td><span style="color: gray"><em>none</em></span></td>
<td><span style="color: gray"><em>none</em></span></td>
<td>show users</td>
<td></td>
</tr><tr><td><a name="create-user" id="create-user"></a><a href="#create-user-note">create user</a></td>
<td><span style="color: gray"><em>at sql prompt:</em></span><br /><span style="white-space: pre-wrap;">&gt;</span> create role fred with superuser<br /><span style="white-space: pre-wrap;">  </span>createdb createrole login;<br /><br /><span style="color: gray"><em>at cmd line; will prompt for privileges:</em></span><br />
$ createuser fred</td>
<td>create user 'fred'@'localhost' identified by 'abc123';</td>
<td><span style="color: gray"><em>none</em></span></td>
<td><span style="color: gray"><em>none</em></span></td>
<td><span style="color: gray"><em>Mongo 2.0:</em></span><br />
db.addUser("fred", "abc123")<br /><br /><span style="color: gray"><em>Mongo 2.4:</em></span><br />
db.addUser({user: "fred", pwd: "abc123", roles: ["readWrite"]})</td>
<td></td>
</tr><tr><td><a name="switch-user" id="switch-user"></a><a href="#switch-user-note">switch user</a></td>
<td>set role fred;</td>
<td></td>
<td></td>
<td></td>
<td>db.auth("fred", "abc123")</td>
<td></td>
</tr><tr><td><a name="drop-user" id="drop-user"></a><a href="#drop-user-note">drop user</a></td>
<td><span style="white-space: pre-wrap;">&gt;</span> drop role fred;<br /><br />
$ dropuser fred</td>
<td>drop user 'fred'@'localhost';</td>
<td><span style="color: gray"><em>none</em></span></td>
<td><span style="color: gray"><em>none</em></span></td>
<td>db.removeUser("fred")</td>
<td></td>
</tr><tr><td><a name="set-password" id="set-password"></a><a href="#set-password-note">set password</a></td>
<td>alter user fred with password 'xyz789';</td>
<td>set password for 'fred'@'localhost' = password('xyz789');</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td><a name="grant" id="grant"></a><a href="#grant-note">grant</a></td>
<td></td>
<td>grant select on test.foo to 'fred'@'localhost';</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td><a name="grant-all" id="grant-all"></a><a href="#grant-all-note">grant all</a></td>
<td></td>
<td><span style="color: gray"><em>table foo in database test:</em></span><br />
grant all on test.foo to 'fred'@'localhost';<br /><br /><span style="color: gray"><em>all tables in database test:</em></span><br />
grant all on test.* to 'fred'@'localhost';</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td><a name="revoke" id="revoke"></a><a href="#revoke-note">revoke</a></td>
<td></td>
<td>revoke all on test.* from 'fred'@'localhost';</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th colspan="7"><a name="python" id="python"></a><a href="#python-note">python</a></th>
</tr><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
<th>redis</th>
<th>mongodb</th>
<th>neo4j</th>
</tr><tr><td>install driver</td>
<td>$ sudo pip install psycopg</td>
<td><span style="color: gray"><em>make sure MySQL development files are installed; download MySQLdb source and run the included setup script:</em></span><br />
$ python setup.py install</td>
<td></td>
<td></td>
<td>$ sudo pip install pymongo</td>
<td></td>
</tr><tr><td>import driver</td>
<td>import psycopg2</td>
<td>import MySQLdb</td>
<td></td>
<td></td>
<td>import pymongo</td>
<td></td>
</tr><tr><td>connect<br /><span style="color: gray"><em>open, close</em></span></td>
<td>conn = psycopg2.connect(database='foo')<br /><br />
conn.close()</td>
<td></td>
<td></td>
<td></td>
<td>client = pymongo.Connection('localhost')<br />
db = conn['foo']</td>
<td></td>
</tr><tr><td>cursor<br /><span style="color: gray"><em>create, close</em></span></td>
<td>cur = conn.cursor()<br /><br />
cur.close()</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>execute</td>
<td>cur.execute('select * from bar')</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>bind variable</td>
<td>cur.execute('select * from foo where bar = %s', vars=[1])</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>fetch all results</td>
<td><span style="color: gray"># returns list of tuples:</span><br />
rows = cur.fetchall()</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>iterate thru results</td>
<td>for row in cur:<br /><span style="white-space: pre-wrap;">  </span>print(row[0])</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>fetch one result</td>
<td><span style="color: gray"># returns a tuple:</span><br />
row = cur.fetchone()</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>transaction</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th colspan="7"><a name="ruby" id="ruby"></a><a href="#ruby-note">ruby</a></th>
</tr><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
<th>redis</th>
<th>mongodb</th>
<th>neo4j</th>
</tr><tr><td>install driver</td>
<td>$ sudo gem install ruby-pg</td>
<td>$ sudo gem install mysql</td>
<td></td>
<td></td>
<td>$ sudo gem install mongo bson_ext</td>
<td></td>
</tr><tr><td>import driver</td>
<td>require 'pg'</td>
<td>require 'mysql'</td>
<td></td>
<td></td>
<td>require 'mongo'</td>
<td></td>
</tr><tr><td>connect<br /><span style="color: gray"><em>open, close</em></span></td>
<td>conn = PGconn.open(:dbname =&gt; 'foo')</td>
<td>conn = Mysql.new<br />
conn.select_db("foo")</td>
<td></td>
<td></td>
<td>conn = Mongo::MongoClient.new('localhost', 27017)<br />
db = conn["foo"]</td>
<td></td>
</tr><tr><td>execute</td>
<td>result = conn.exec("select * from foo;")</td>
<td>stmt = con.prepare('select * from foo')<br />
stmt.execute</td>
<td></td>
<td></td>
<td>coll = db["foo"]<br />
coll.find().each {|doc| puts doc}</td>
<td></td>
</tr><tr><td>bind variable</td>
<td></td>
<td>stmt = con.prepare('select * from foo where bar = ?')<br />
stmt.execute(1)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>number of rows returned</td>
<td>result.cmdtuples</td>
<td>stmt.num_rows</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>fetch a row</td>
<td><span style="color: gray"># hash with column names as keys:</span><br />
result[0]</td>
<td><span style="color: gray"># returns array:</span><br />
stmt.fetch</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>iterate thru results</td>
<td>result.each do |row|<br /><span style="white-space: pre-wrap;">  </span>puts row["bar"]<br />
end</td>
<td>stmt.each do |row|<br /><span style="white-space: pre-wrap;">  </span>puts row[0]<br />
end</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>transaction</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th colspan="7"><a name="help" id="help"></a><a href="#help-note">help</a></th>
</tr><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
<th>redis</th>
<th>mongodb</th>
<th>neo4j</th>
</tr><tr><td>man page</td>
<td>$ man 1 psql<br />
$ man 7 copy<br />
$ man 7 create_table</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><th colspan="7"><a name="admin" id="admin"></a><a href="#admin-note">admin</a></th>
</tr><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
<th>redis</th>
<th>mongodb</th>
<th>neo4j</th>
</tr><tr><td><a name="admin-user" id="admin-user"></a><a href="#admin-user-note">admin user</a></td>
<td>postgres</td>
<td>root</td>
<td><span style="color: gray"><em>none</em></span></td>
<td><span style="color: gray"><em>none</em></span></td>
<td></td>
<td></td>
</tr><tr><td><a name="server-proc" id="server-proc"></a><a href="#server-proc-note">server process</a></td>
<td>postgres</td>
<td>mysqld</td>
<td><span style="color: gray"><em>none</em></span></td>
<td>redis-server</td>
<td>mongodb</td>
<td></td>
</tr><tr><td><a name="start-server" id="start-server"></a><a href="#start-server-note">start server</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>$ mongodb <span style="white-space: pre-wrap;">--</span>config /path/to/mongo.conf</td>
<td></td>
</tr><tr><td><a name="stop-server" id="stop-server"></a><a href="#stop-server-note">stop server</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>use admin<br />
db.shutdownServer()</td>
<td></td>
</tr><tr><td><a name="config-file" id="config-file"></a><a href="#config-file-note">config file</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><span style="color: gray"><em>passed to</em> mongod <em>with</em> -f <em>or</em> <span style="white-space: pre-wrap;">--</span>config <em>option</em></span><br /><br />
/usr/local/etc/mongod.conf</td>
<td></td>
</tr><tr><td><a name="reload-config-file" id="reload-config-file"></a><a href="#reload-config-file-note">reload config file</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td><a name="data-dir" id="data-dir"></a><a href="#data-dir-note">data directory</a></td>
<td><span style="color: gray"><em>data directory is passed to server process using</em> -D <em>option:</em></span><br />
$ ps aux | grep postgres</td>
<td>/usr/local/var/mysql</td>
<td><span style="color: gray"><em>specified on command line</em></span></td>
<td>/opt/local/var/db/redis</td>
<td><span style="color: gray"><em>parameter</em> dbpath <em>in config file</em></span><br /><br />
/usr/local/var/mongodb</td>
<td></td>
</tr><tr><td><a name="create-db" id="create-db"></a><a href="#create-db-note">create database</a></td>
<td><span style="color: gray"><em>at sql prompt:</em></span><br /><span style="white-space: pre-wrap;">&gt;</span> create database foo;<br /><br /><span style="color: gray"><em>at command line:</em></span><br />
$ createdb foo</td>
<td></td>
<td></td>
<td></td>
<td><span style="color: gray"><em>use will take as an argument a database which does not exist; the database will be created when data is saved</em></span><br />
use db1<br />
db.collection1.save({"key1": "val1"})</td>
<td></td>
</tr><tr><td><a name="drop-db" id="drop-db"></a><a href="#drop-db-note">drop database</a></td>
<td><span style="white-space: pre-wrap;">&gt;</span> drop database foo;<br /><br />
$ dropdb foo</td>
<td></td>
<td></td>
<td></td>
<td>use db1<br />
db.dropDatabase()</td>
<td></td>
</tr><tr><td><a name="backup-db" id="backup-db"></a><a href="#backup-db-note">backup database</a></td>
<td>$ pg_dump <span style="color: gray"><em>db</em></span> &gt; /tmp/<span style="color: gray"><em>db</em></span>.sql<br /><br />
$ pg_dump -F=c <span style="color: gray"><em>db</em></span> &gt; /tmp/<span style="color: gray"><em>db</em></span>.postgres</td>
<td></td>
<td></td>
<td></td>
<td><span style="color: gray"><em>backups are per collection:</em></span><br />
$ mongoexport -d <span style="color: gray"><em>db</em></span> -c <span style="color: gray"><em>collection</em></span> &gt; /tmp/dump.json</td>
<td></td>
</tr><tr><td><a name="restore-db" id="restore-db"></a><a href="#restore-db-note">restore database</a></td>
<td>$ psql -f /tmp/<span style="color: gray"><em>db</em></span>.sql<br /><br />
$ pg_restore -d <span style="color: gray"><em>db</em></span> /tmp/<span style="color: gray"><em>db</em></span>.postgres</td>
<td></td>
<td></td>
<td></td>
<td><span style="color: gray"><em>backups are per collection:</em></span><br />
$ mongoimport -d <span style="color: gray"><em>db</em></span> -c <span style="color: gray"><em>collection</em></span> &lt; /tmp/dump.json</td>
<td></td>
</tr><tr><th></th>
<th><span style="color: #efefef"><span style="white-space: pre-wrap;">_________________________________</span></span></th>
<th><span style="color: #efefef"><span style="white-space: pre-wrap;">_________________________________</span></span></th>
<th><span style="color: #efefef"><span style="white-space: pre-wrap;">_________________________________</span></span></th>
<th><span style="color: #efefef"><span style="white-space: pre-wrap;">_________________________________</span></span></th>
<th><span style="color: #efefef"><span style="white-space: pre-wrap;">_________________________________</span></span></th>
<th><span style="color: #efefef"><span style="white-space: pre-wrap;">_________________________________</span></span></th>
</tr></table><p><a name="correspondence" id="correspondence"></a></p>
<h1 id="toc0"><span><a href="#top">Data Model Correspondence</a></span></h1>
<table class="wiki-content-table"><tr><th>relational db</th>
<th>key-value store</th>
<th>document-oriented db</th>
<th>graph db</th>
</tr><tr><td><span style="color: gray"><em>PostgreSQL, MySQL, SQLite</em></span></td>
<td><span style="color: gray"><em>Redis</em></span></td>
<td><span style="color: gray"><em>MongoDB</em></span></td>
<td><span style="color: gray"><em>Neo4j</em></span></td>
</tr><tr><td>database</td>
<td>database</td>
<td>database</td>
<td>graph</td>
</tr><tr><td>table</td>
<td>key-value pairs with shared key prefix</td>
<td>collection</td>
<td>nodes with shared label <span style="color: gray"><em>or</em></span> relationships with shared type</td>
</tr><tr><td>record (row)</td>
<td>key-value pair</td>
<td>document</td>
<td>node <span style="color: gray"><em>or</em></span> relationship</td>
</tr><tr><td>primary key</td>
<td>key</td>
<td>_id field</td>
<td>a unique property</td>
</tr><tr><td>field (column)</td>
<td>list element <span style="color: gray"><em>or</em></span> hash value</td>
<td>field</td>
<td>property</td>
</tr></table><h2 id="toc1"><span>Key-Value Store</span></h2>
<p>To store a relational database in Redis, one can store each row under the key <span style="color: gray"><em>table</em></span>:<span style="color: gray"><em>primary_key</em></span>, where <span style="color: gray"><em>table</em></span> is the name of the table containing the row and <span style="color: gray"><em>primary_key</em></span> is the primary key of the row. Redis values can be arrays (Redis calls them lists) or dictionaries (Redis calls them hashes) and either can be used to store the remaining fields in the row.</p>
<p>Conversely reading a Redis database into a relational database involves identifying a partitioning scheme for the key-value pairs such that each partition can be stored in a table. Redis does not enforce a schema, so finding the partitioning scheme could be difficult. If the partitioning scheme is not perfect, then the code which performs the import must be prepared to handle error conditions.</p>
<h2 id="toc2"><span>Document-Oriented Database</span></h2>
<p>To store a relational database in MongoDB, each table can be a collection and each row a document. However, if some of the tables in the relational database occur in a star or snowflake pattern, then it is advantageous to store those tables in a single collection. For our purposes a star pattern is an independent table and one or more dependent tables which are connected to the independent table by one-to-many joins. That is, each row in the dependent table joins to a single row in the independent table. In the snowflake pattern the dependent tables can themselves have tables which are dependent on them.</p>
<p>If a table is dependent on more than one independent table, store the dependent table in the collection of the independent table with which it is joined most often. That collection should contain _id values of documents in the other collection.</p>
<p>To read a MongoDB database into a relational database, one starts by scanning each collection to get a list of the fields it uses and the type of their values. If any of the fields has array values, then a dependent table must be introduced. If the field has an object value, a dependent table with a 1-1 join can be introduced, but one also has the option of flattening the values into the independent table. If fields have values with a mix of types, then one has encountered a difficult situation. In any case import code should be prepared to handle error conditions from unexpected data.</p>
<h2 id="toc3"><span>Graph Database</span></h2>
<p>To store a relational database in Neo4j, most rows should be converted to nodes with a label identifying the table it came from. An exception is N-N mapping tables whose rows should be converted to relationships. Additionally when two columns can be joined, a relationship should be created for each pair of rows with a common join value.</p>
<p>When a row is converted to a node, store the fields of the row in the properties of the node.</p>
<p>When reading a Neo4j database into a relational database, one must partition the nodes into sets, each which is appropriate for insertion into a table. Possibly the labels can be used to identify the sets, but one must also have to consider the properties or the relationships. To determine the fields for the destination table, one must scan all the nodes in the set to get a complete list of property keys.</p>
<h2 id="toc4"><span><a href="#version-used">version used</a></span></h2>
<p>The version used to test the examples in this sheet.</p>
<p><a name="show-version-note" id="show-version-note"></a></p>
<h2 id="toc5"><span><a href="#show-version">show version</a></span></h2>
<p>How to determine the version of a database engine.</p>
<p><strong>mysql:</strong></p>
<p>MySQL supports different storage engines. Each storage engine has its own size limits, and features such as indexes, transactions, locking and foreign key support aren't available for all storage engines.</p>
<p>Here is how to determine the storage engine used for a table:</p>
<div class="code">
<pre>
<code>select engine
from information_schema.tables
where table_schema = 'test'
  and table_name = 'foo';</code>
</pre></div>
<p><a name="arch-note" id="arch-note"></a></p>
<h1 id="toc6"><span><a href="#arch">Architecture</a></span></h1>
<p><a name="engine-arch-note" id="engine-arch-note"></a></p>
<h2 id="toc7"><span><a href="#engine-arch">engine</a></span></h2>
<p>The location of the database engine.</p>
<p><a name="data-arch-note" id="data-arch-note"></a></p>
<h2 id="toc8"><span><a href="#data-arch">data</a></span></h2>
<p>How data is organized in a database.</p>
<p><a name="files-arch-note" id="files-arch-note"></a></p>
<h2 id="toc9"><span><a href="#files-arch">files</a></span></h2>
<p>How data is stored in files on the file system.</p>
<p><strong>postgresql:</strong></p>
<p>Tables are split into multiple files when they exceed 2G; large attributes are stored in separate TOAST files.</p>
<p><a name="persistence-arch-note" id="persistence-arch-note"></a></p>
<h2 id="toc10"><span><a href="#persistence-arch">persistence</a></span></h2>
<p>What durability guarantee is made and how this is accomplished.</p>
<p><a name="indices-arch-note" id="indices-arch-note"></a></p>
<h2 id="toc11"><span><a href="#indices-arch">indices</a></span></h2>
<p>Are indices available and what can be indexed.</p>
<p><a name="txn-arch-note" id="txn-arch-note"></a></p>
<h2 id="toc12"><span><a href="#txn-arch">transactions</a></span></h2>
<p>Are transactions available and what can participate in a transaction.</p>
<p><a name="security-arch-note" id="security-arch-note"></a></p>
<h2 id="toc13"><span><a href="#security-arch">security</a></span></h2>
<p>Available security features.</p>
<p><a name="server-lang-arch-note" id="server-lang-arch-note"></a></p>
<h2 id="toc14"><span><a href="#server-lang-arch">server side language</a></span></h2>
<p>Whether a server side programming language is available.</p>
<p><a name="client-note" id="client-note"></a></p>
<h1 id="toc15"><span><a href="#client">Client</a></span></h1>
<p><a name="invoke-client-note" id="invoke-client-note"></a></p>
<h2 id="toc16"><span><a href="#invoke-client">invoke client</a></span></h2>
<p>How to invoke the command line client.</p>
<p><strong>postgresql:</strong></p>
<p>If the database user is not specified, it will default to the operating system user. If the database is not specified, it will default to the operating system user. If the host is not specified, <em>psql</em> will attempt to connect to a server on the local host using a Unix domain socket.</p>
<p><a name="client-help-note" id="client-help-note"></a></p>
<h2 id="toc17"><span><a href="#client-help">client help</a></span></h2>
<p>How to get a list of commands available at the command line client prompt.</p>
<p><a name="default-port-note" id="default-port-note"></a></p>
<h2 id="toc18"><span><a href="#default-port">default port</a></span></h2>
<p>The default port used by the client to connect to the server.</p>
<p>The default ports used by PostgreSQL and MySQL are defined in <tt>/etc/services</tt>.</p>
<p><a name="show-db-note" id="show-db-note"></a></p>
<h2 id="toc19"><span><a href="#show-db">show databases</a></span></h2>
<p>List the available databases on a server.</p>
<p><a name="switch-db-note" id="switch-db-note"></a></p>
<h2 id="toc20"><span><a href="#switch-db">switch database</a></span></h2>
<p>How to switch between databases when using the command line SQL prompt.</p>
<p><a name="chdir-note" id="chdir-note"></a></p>
<h2 id="toc21"><span><a href="#chdir">chdir</a></span></h2>
<p><a name="shell-cmd-note" id="shell-cmd-note"></a></p>
<h2 id="toc22"><span><a href="#shell-cmd">shell command</a></span></h2>
<p><a name="client-startup-file-note" id="client-startup-file-note"></a></p>
<h2 id="toc23"><span><a href="#client-startup-file">client startup file</a></span></h2>
<p>The name of the startup file used by the client.</p>
<p><a name="custom-prompt-note" id="custom-prompt-note"></a></p>
<h2 id="toc24"><span><a href="#custom-prompt">custom prompt</a></span></h2>
<ul><li><a href="http://www.postgresql.org/docs/8.4/interactive/app-psql.html#APP-PSQL-PROMPTING">PostgreSQL Prompting</a></li>
</ul><p><a name="select-note" id="select-note"></a></p>
<h1 id="toc25"><span><a href="#select">Select</a></span></h1>
<p><a name="where-note" id="where-note"></a></p>
<h1 id="toc26"><span><a href="#where">Where</a></span></h1>
<p><a name="join-note" id="join-note"></a></p>
<h1 id="toc27"><span><a href="#join">Join</a></span></h1>
<p><a name="aggregate-note" id="aggregate-note"></a></p>
<h1 id="toc28"><span><a href="#aggregate">Aggregate</a></span></h1>
<p><a name="sort-limit-note" id="sort-limit-note"></a></p>
<h1 id="toc29"><span><a href="#sort-limit">Sort and Limit</a></span></h1>
<p><a name="insert-update-delete-note" id="insert-update-delete-note"></a></p>
<h1 id="toc30"><span><a href="#insert-update-delete">Insert, Update, and Delete</a></span></h1>
<p><a name="insert-note" id="insert-note"></a></p>
<h2 id="toc31"><span><a href="#insert">insert</a></span></h2>
<p><a name="update-note" id="update-note"></a></p>
<h2 id="toc32"><span><a href="#update">update</a></span></h2>
<p><a name="delete-note" id="delete-note"></a></p>
<h2 id="toc33"><span><a href="#delete">delete</a></span></h2>
<p><a name="delete-all-rows-note" id="delete-all-rows-note"></a></p>
<h2 id="toc34"><span><a href="#delete-all-rows">delete all rows</a></span></h2>
<p><a name="schema-note" id="schema-note"></a></p>
<h1 id="toc35"><span><a href="#schema">Schema</a></span></h1>
<p><a name="create-table-note" id="create-table-note"></a></p>
<h2 id="toc36"><span><a href="#create-table">create table</a></span></h2>
<p><a name="drop-table-note" id="drop-table-note"></a></p>
<h2 id="toc37"><span><a href="#drop-table">drop table</a></span></h2>
<p><a name="show-tables-note" id="show-tables-note"></a></p>
<h2 id="toc38"><span><a href="#show-tables">show tables</a></span></h2>
<p>List the tables in the current database.</p>
<p><a name="describe-table-note" id="describe-table-note"></a></p>
<h2 id="toc39"><span><a href="#describe-table">describe table</a></span></h2>
<p>Show the columns for a table and their types.</p>
<p><a name="sequences-note" id="sequences-note"></a></p>
<h1 id="toc40"><span><a href="#sequences">Sequences</a></span></h1>
<p><a name="incr-note" id="incr-note"></a></p>
<h2 id="toc41"><span><a href="#incr">increment</a></span></h2>
<p><a name="indices-note" id="indices-note"></a></p>
<h1 id="toc42"><span><a href="#indices">Indices</a></span></h1>
<p><a name="import-export-note" id="import-export-note"></a></p>
<h1 id="toc43"><span><a href="#import-export">Import and Export</a></span></h1>
<p><a name="import-tab-note" id="import-tab-note"></a></p>
<h2 id="toc44"><span><a href="#import-tab">import tab delimited</a></span></h2>
<p><a name="import-csv-note" id="import-csv-note"></a></p>
<h2 id="toc45"><span><a href="#import-csv">import csv</a></span></h2>
<p><a name="import-json-note" id="import-json-note"></a></p>
<h2 id="toc46"><span><a href="#import-json">import json</a></span></h2>
<p><a name="export-tab-note" id="export-tab-note"></a></p>
<h2 id="toc47"><span><a href="#export-tab">export tab delimited</a></span></h2>
<p><a name="export-csv-note" id="export-csv-note"></a></p>
<h2 id="toc48"><span><a href="#export-csv">export csv</a></span></h2>
<p><a name="export-json-note" id="export-json-note"></a></p>
<h2 id="toc49"><span><a href="#export-json">export json</a></span></h2>
<p><a name="script-note" id="script-note"></a></p>
<h1 id="toc50"><span><a href="#script">Script</a></span></h1>
<p><a name="sql-script-note" id="sql-script-note"></a></p>
<h2 id="toc51"><span><a href="#sql-script">run sql script</a></span></h2>
<p>How to run a SQL script at the command line.</p>
<p><a name="func-note" id="func-note"></a></p>
<h1 id="toc52"><span><a href="#func">Function</a></span></h1>
<p><a name="show-func-note" id="show-func-note"></a></p>
<h2 id="toc53"><span><a href="#show-func">show functions</a></span></h2>
<p>List the stored functions in the current database.</p>
<p><a name="show-func-src-note" id="show-func-src-note"></a></p>
<h2 id="toc54"><span><a href="#show-func-src">show function source</a></span></h2>
<p><a name="user-note" id="user-note"></a></p>
<h1 id="toc55"><span><a href="#user">User</a></span></h1>
<p><a name="current-user-note" id="current-user-note"></a></p>
<h2 id="toc56"><span><a href="#current-user">current user</a></span></h2>
<p><a name="list-users-note" id="list-users-note"></a></p>
<h2 id="toc57"><span><a href="#list-users">list users</a></span></h2>
<p><a name="create-user-note" id="create-user-note"></a></p>
<h2 id="toc58"><span><a href="#create-user">create user</a></span></h2>
<p><a name="switch-user-note" id="switch-user-note"></a></p>
<h2 id="toc59"><span><a href="#switch-user">switch user</a></span></h2>
<p><a name="drop-user-note" id="drop-user-note"></a></p>
<h2 id="toc60"><span><a href="#drop-user">drop user</a></span></h2>
<p><a name="set-password-note" id="set-password-note"></a></p>
<h2 id="toc61"><span><a href="#set-password">set password</a></span></h2>
<p><a name="grant-note" id="grant-note"></a></p>
<h2 id="toc62"><span><a href="#grant">grant</a></span></h2>
<p><a name="grant-all-note" id="grant-all-note"></a></p>
<h2 id="toc63"><span><a href="#grant-all">grant all</a></span></h2>
<p><a name="revoke-note" id="revoke-note"></a></p>
<h2 id="toc64"><span><a href="#revoke">revoke</a></span></h2>
<p><a name="query-tuning-note" id="query-tuning-note"></a></p>
<h1 id="toc65"><span><a href="#query-tuning">Query Tuning</a></span></h1>
<p><a name="python-note" id="python-note"></a></p>
<h1 id="toc66"><span><a href="#python">Python</a></span></h1>
<p><a name="ruby-note" id="ruby-note"></a></p>
<h1 id="toc67"><span><a href="#ruby">Ruby</a></span></h1>
<p><a name="admin-note" id="admin-note"></a></p>
<h1 id="toc68"><span><a href="#admin">Admin</a></span></h1>
<p><a name="admin-user-note" id="admin-user-note"></a></p>
<h2 id="toc69"><span><a href="#admin-user">admin user</a></span></h2>
<p><a name="server-proc-note" id="server-proc-note"></a></p>
<h2 id="toc70"><span><a href="#server-proc">server process</a></span></h2>
<p><a name="start-server-note" id="start-server-note"></a></p>
<h2 id="toc71"><span><a href="#start-server">start server</a></span></h2>
<p><a name="stop-server-note" id="stop-server-note"></a></p>
<h2 id="toc72"><span><a href="#stop-server">stop server</a></span></h2>
<p><a name="config-file-note" id="config-file-note"></a></p>
<h2 id="toc73"><span><a href="#config-file">config file</a></span></h2>
<p><a name="reload-config-file-note" id="reload-config-file-note"></a></p>
<h2 id="toc74"><span><a href="#reload-config-file">reload config file</a></span></h2>
<p><a name="create-db-note" id="create-db-note"></a></p>
<h2 id="toc75"><span><a href="#create-db">create database</a></span></h2>
<p>How to create a database.</p>
<p><strong>postgresql:</strong></p>
<p>The user must have the <tt>CREATEDB</tt> privilege. When creating the database from the command line using <tt>createdb</tt>, the PostgreSQL user can be specified using the <tt>-U</tt> option.</p>
<p><a name="drop-db-note" id="drop-db-note"></a></p>
<h2 id="toc76"><span><a href="#drop-db">drop database</a></span></h2>
<p>How to drop a database.</p>
<p><a name="backup-db-note" id="backup-db-note"></a></p>
<h2 id="toc77"><span><a href="#backup-db">backup database</a></span></h2>
<p><a name="restore-db-note" id="restore-db-note"></a></p>
<h2 id="toc78"><span><a href="#restore-db">restore database</a></span></h2>
<p><em>Writing SELECT queries for open-source databases.</em></p>
<p>The reader is assumed to have written SELECT queries with FROM, WHERE, GROUP BY, HAVING, and ORDER BY clauses.</p>
<p>When we say that something is <em>standard</em>, we mean it conforms to the most recent SQL standard.</p>
<p>When we say that something is <em>portable</em>, we mean works on PostgreSQL, MySQL, and SQLite.</p>
<p><a name="types" id="types"></a></p>
<h1 id="toc79"><span><a href="#top">Types</a></span></h1>
<p>A list of portable types:</p>
<ul><li>BOOLEAN</li>
<li>INTEGER <span style="color: gray"><em>or</em></span> INT</li>
<li>REAL</li>
<li>DOUBLE PRECISION</li>
<li>NUMERIC(<span style="color: gray"><em>total digits</em></span>, <span style="color: gray"><em>fractional digits</em></span>)</li>
<li>NUMERIC(<span style="color: gray"><em>total digits</em></span>)</li>
<li>CHARACTER(<span style="color: gray"><em>len</em></span>) <span style="color: gray"><em>or</em></span> CHAR(<span style="color: gray"><em>len</em></span>)</li>
<li>CHARACTER VARYING(<span style="color: gray"><em>len</em></span>) <span style="color: gray"><em>or</em></span> VARCHAR(<span style="color: gray"><em>len</em></span>)</li>
<li>TIMESTAMP</li>
<li>DATE</li>
<li>TIME</li>
</ul><p>Note that <tt>NUMERIC(<span style="color: gray"><em>len</em></span>)</tt> defines an integer type.</p>
<p><strong>mysql:</strong></p>
<p>MySQL maps BOOLEAN to TINYINT(1); REAL and DOUBLE PRECISION to DOUBLE; NUMERIC to DECIMAL.</p>
<p><a name="casts" id="casts"></a></p>
<h1 id="toc80"><span><a href="#top">Casts</a></span></h1>
<p>This is the standard and portable way to cast:</p>
<div class="code">
<pre>
<code>SELECT cast('7' AS INTEGER) + 3;</code>
</pre></div>
<p>The standard calls for implicit casts between numeric types.</p>
<p>The standard also calls for implicit casts between character types. In particular, character types can be concatenated, and the length of the concatenation type is the sum of the length of the argument types.</p>
<p><strong>postgresql:</strong></p>
<p>Other ways to cast:</p>
<div class="code">
<pre>
<code>&gt; SELECT '7'::INTEGER + 3;
&gt; SELECT INTEGER '7' + 3;</code>
</pre></div>
<p>The type of string operations is TEXT, which is a character type of unlimited length.</p>
<p>It is an error to attempt to insert a string that is too long into a column with fixed or maximum length.</p>
<p><strong>mysql:</strong></p>
<p>When concatenating character types, the length of the type of the concatenation is the sum of the length of the type of the arguments.</p>
<p>MySQL silently truncates strings that are too long on insert.</p>
<p><strong>sqlite:</strong></p>
<p>SQLite does not enforce character type length limits.</p>
<p><a name="literals" id="literals"></a></p>
<h1 id="toc81"><span><a href="#top">Literals</a></span></h1>
<p>The standard reserves these keywords: NULL, TRUE, and FALSE.</p>
<p>Numeric literals work like you would expect.</p>
<p>SQL strings are admirably simple. Single quote delimited, double the single quote to escape, double pipe for concatenation.</p>
<p><strong>postgresql:</strong></p>
<p>This code results in a type mismatch error:</p>
<div class="code">
<pre>
<code>SELECT TRUE = 1;</code>
</pre></div>
<p>Converting a string containing a hex digit to an integer:</p>
<div class="code">
<pre>
<code>&gt; select x'3bb'::int;
 int4 
------
  955</code>
</pre></div>
<p>The <tt>chr()</tt> function takes an integer representing a Unicode point as an argument:</p>
<div class="code">
<pre>
<code>&gt; SELECT 'one' || chr(10) || 'two' || chr(10) || 'three';
 ?column? 
----------
 one     +
 two     +
 three

&gt; SELECT chr(x'3bb'::int);
 chr 
-----
 λ</code>
</pre></div>
<p>There is syntax for strings with C-style backslash escapes:</p>
<div class="code">
<pre>
<code>select E'one\ntwo\nthree';</code>
</pre></div>
<p><strong>mysql:</strong></p>
<p>TRUE and FALSE are synonyms for 1 and 0.</p>
<p>The <tt><span style="white-space: pre-wrap;">||</span></tt> operator is used for logical disjunction. Use the <tt>concat()</tt> function for string concatenation.</p>
<blockquote>
<p>SELECT concat('one', char(10), 'two');</p>
</blockquote>
<div class="code">
<pre>
<code>+--------------------------------+
| concat('one', char(10), 'two') |
+--------------------------------+
| one
two                        |
+--------------------------------+</code>
</pre></div>
<p><strong>sqlite:</strong></p>
<p>SQLite does not have TRUE and FALSE literals. Use 1 and 0 instead.</p>
<p>Strings can be single quote or double quote delimited.</p>
<p><a name="dates" id="dates"></a></p>
<h1 id="toc82"><span><a href="#top">Dates</a></span></h1>
<p>The standard provides the keywords CURRENT_TIME, CURRENT_DATE, and CURRENT_TIMESTAMP for observing the clock.</p>
<p>There are no date literals; strings are used instead. Inserting a string into a TIME, DATE, or TIMESTAMP column will work if <a href="http://en.wikipedia.org/wiki/ISO_8601">ISO 8601 format</a> is used.</p>
<div class="code">
<pre>
<code>&gt; CREATE TABLE foo (a DATE, b TIME, c TIMESTAMP);

&gt; INSERT INTO foo VALUES ('2012-10-19', '18:00:00', '2012-10-19 18:00:00');</code>
</pre></div>
<p>This works in both MySQL and PostgreSQL:</p>
<div class="code">
<pre>
<code>&gt; SELECT date('2012-10-19'), time('18:00:00'), timestamp('2012-10-19 18:00:00');</code>
</pre></div>
<p>EXTRACT, TIMESTAMP from DATE and TIME, STRFTIME, STRPTIME</p>
<p><span style="color: gray"><em>INTERVAL type and date arithmetic</em></span></p>
<ul><li>TIMESTAMP - TIMESTAMP</li>
<li>TIMESTAMP + INTERVAL and INTERVAL + TIMESTAMP</li>
<li>INTERVAL + INTERVAL and INTERVAL - INTERVAL</li>
<li>INTERVAL * NUMERIC and NUMERIC * INTERVAL</li>
<li>INTERVAL / NUMERIC</li>
</ul><p><strong>mysql:</strong></p>
<p>MySQL does not have an INTERVAL type. Subtracting two TIMESTAMPs yields a NUMERIC(20, 0) and subtracting two DATEs yields a NUMERIC(11, 0).</p>
<p><a name="identifiers" id="identifiers"></a></p>
<h1 id="toc83"><span><a href="#top">Identifiers</a></span></h1>
<p>According to the standard, identifiers with unusual characters should be double quoted. A literal double quote is represented by two double quotes.</p>
<p><strong>mysql:</strong></p>
<p>MySQL uses backticks <span style="white-space: pre-wrap;">``</span> instead of double quotes "" to quote identifiers.</p>
<p><a name="op" id="op"></a></p>
<h1 id="toc84"><span><a href="#top">Operators</a></span></h1>
<ul><li>AND OR NOT</li>
<li>&lt; &gt; &lt;= &gt;= = != (&lt;&gt;)</li>
<li>BETWEEN IN</li>
<li>+ - * / % ^</li>
<li>&amp; | # ~ <span style="white-space: pre-wrap;"> &lt;&lt;</span> <span style="white-space: pre-wrap;">&gt;&gt; </span></li>
<li><span style="white-space: pre-wrap;">||</span> LIKE (ESCAPE)</li>
</ul><div class="code">
<pre>
<code>-- select rows where foo.x ends with percent sign
--
SELECT *
FROM foo
WHERE x LIKE '%\%' ESCAPE '\';</code>
</pre></div>
<p><em>check mysql and sqlite</em></p>
<p><a name="func" id="func"></a></p>
<h1 id="toc85"><span><a href="#top">Functions</a></span></h1>
<p><em>how to get a list of functions</em></p>
<p><a href="http://dev.mysql.com/doc/refman/5.5/en/functions.html">MySQL 5.5 Functions and Operators</a><br /><a href="http://dev.mysql.com/doc/refman/5.5/en/dynindex-function.html">MySQL 5.5 Function Index</a><br /><a href="http://www.sqlite.org/lang_corefunc.html">SQLite Core Functions</a><br /><a href="http://www.sqlite.org/lang_aggfunc.html">SQLite Aggregate Functions</a><br /><a href="http://www.sqlite.org/lang_datefunc.html">SQLite Date and Time Functions</a></p>
<p><a name="distinct" id="distinct"></a></p>
<h1 id="toc86"><span><a href="#top">DISTINCT</a></span></h1>
<p>Some of the places DISTINCT can be used:</p>
<ul><li>SELECT DISTINCT <span style="color: gray"><em>expr <span style="white-space: pre-wrap;">...</span></em></span></li>
<li>SELECT count(DISTINCT <span style="color: gray"><em>expr</em></span>)</li>
<li>UNION DISTINCT</li>
<li>INTERSECT DISTINCT</li>
<li>EXCEPT DISTINCT</li>
</ul><p>UNION ALL, INTERSECT ALL, and EXCEPT ALL can be used to indicate multiset operations. UNION DISTINCT, INTERSECT DISTINCT, and EXCEPT DISTINCT indicate set operations. Since this is the default the use of DISTINCT is superfluous.</p>
<p><a name="qualified-asterisk" id="qualified-asterisk"></a></p>
<h1 id="toc87"><span><a href="#top">Qualified *</a></span></h1>
<div class="code">
<pre>
<code>-- Example of a qualified *: only 
-- return rows from foo:
--
SELECT foo.*
FROM foo
JOIN bar
  ON foo.x = bar.x</code>
</pre></div>
<p><a name="regex" id="regex"></a></p>
<h1 id="toc88"><span><a href="#top">Regular Expressions</a></span></h1>
<p>SIMILAR TO <span style="color: gray"><em>Postgres</em></span></p>
<p><a name="sequences" id="sequences"></a></p>
<h1 id="toc89"><span><a href="#top">Sequences</a></span></h1>
<p>Here is the SQL standard syntax for external sequences:</p>
<div class="code">
<pre>
<code>CREATE SEQUENCE foo;

CREATE SEQUENCE bar START WITH 1000 INCREMENT BY 10 MAXVALUE 2000;

SELECT NEXT VALUE FOR foo;

ALTER SEQUENCE foo RESTART WITH 10;</code>
</pre></div>
<p>Here is the SQL standard syntax for internal sequences. None of the open source databases support this syntax, however.</p>
<div class="code">
<pre>
<code>CREATE TABLE foo (
  foo_id INTEGER GENERATED ALWAYS AS IDENTITY (
    START WITH 1
    INCREMENT BY 1
    MAXVALUE 10000)
)</code>
</pre></div>
<p><strong>postgresql:</strong></p>
<p>PostgreSQL lacks SQL standard syntax for reading external sequences:</p>
<div class="code">
<pre>
<code>CREATE SEQUENCE foo;

CREATE SEQUENCE bar START WITH 1000 INCREMENT BY 10 MAXVALUE 2000;

SELECT nextval('foo');

ALTER SEQUENCE foo RESTART WITH 10;

SELECT setval('foo', 10);</code>
</pre></div>
<p>The keywords <tt>WITH</tt> and <tt>BY</tt> are optional.</p>
<p>How to create an internal sequence:</p>
<div class="code">
<pre>
<code>CREATE TABLE foo 
  foo_id SERIAL,
  foo_desc TEXT
);</code>
</pre></div>
<p><strong>mysql:</strong></p>
<p>MySQL does not have external sequences.</p>
<p><strong>sqlite:</strong></p>
<p>SQLite does not have external sequences.</p>
<div class="code">
<pre>
<code>CREATE TABLE foo (
  foo_id INTEGER PRIMARY KEY AUTOINCREMENT,
  foo_desc TEXT
);</code>
</pre></div>
<p><a name="group-by" id="group-by"></a></p>
<h1 id="toc90"><span><a href="#top">GROUP BY</a></span></h1>
<p>GROUP BY, HAVING, and ORDER BY clauses can refer to SELECT list items by ordinal number. I don't think this is in the standard, but the feature is in PostgreSQL, MySQL, and SQLite.</p>
<p><a name="aggregation-func" id="aggregation-func"></a></p>
<h1 id="toc91"><span><a href="#top">Aggregation Functions</a></span></h1>
<table class="wiki-content-table"><tr><th></th>
<th>postgresql</th>
<th>mysql</th>
<th>sqlite</th>
</tr><tr><td></td>
<td>count, sum, min, max, avg</td>
<td>count, sum, min, max, avg</td>
<td>count, sum, min, max, avg</td>
</tr><tr><td></td>
<td>count(distinct *)<br />
count(distinct <span style="color: gray"><em>expr</em></span>)<br />
sum(distinct <span style="color: gray"><em>expr</em></span>)</td>
<td>count(distinct *)<br />
count(distinct <span style="color: gray"><em>expr</em></span>)<br />
sum(distinct <span style="color: gray"><em>expr</em></span>)</td>
<td>count(distinct *)<br />
count(distinct <span style="color: gray"><em>expr</em></span>)<br />
sum(distinct <span style="color: gray"><em>expr</em></span>)</td>
</tr><tr><td></td>
<td>bit_and<br />
bit_or</td>
<td>bit_and<br />
bit_or</td>
<td></td>
</tr><tr><td></td>
<td>bool_and<br />
bool_or</td>
<td></td>
<td></td>
</tr><tr><td></td>
<td>string_agg(<span style="color: gray"><em>expr</em></span>, <span style="color: gray"><em>delim</em></span>)</td>
<td>group_concat(<span style="color: gray"><em>expr</em></span>)<br />
group_concat(<span style="color: gray"><em>expr</em></span> separator <span style="color: gray"><em>delim</em></span>)</td>
<td></td>
</tr><tr><td></td>
<td>array_agg</td>
<td></td>
<td></td>
</tr><tr><td></td>
<td>stddev_samp<br />
stddev_pop<br />
var_samp<br />
var_pop</td>
<td>stddev_samp<br />
stddev_pop<br />
var_samp<br />
var_pop</td>
<td></td>
</tr><tr><td></td>
<td>cor(<span style="color: gray"><em>X</em></span>, <span style="color: gray"><em>Y</em></span>)<br />
cov_samp(<span style="color: gray"><em>X</em></span>, <span style="color: gray"><em>Y</em></span>)<br />
cor_pop(<span style="color: gray"><em>X</em></span>, <span style="color: gray"><em>Y</em></span>)<br />
regr_intercept(<span style="color: gray"><em>X</em></span>, <span style="color: gray"><em>Y</em></span>)<br />
regr_slope(<span style="color: gray"><em>X</em></span>, <span style="color: gray"><em>Y</em></span>)</td>
<td></td>
<td></td>
</tr></table><p><a name="window-func" id="window-func"></a></p>
<h1 id="toc92"><span><a href="#top">Window Functions</a></span></h1>
<p><em>limits on use</em></p>
<ul><li>can they be used with group by</li>
<li>window functions in WHERE</li>
<li>different window functions in SELECT</li>
</ul><p><em>usefulness</em></p>
<ul><li>pct of total</li>
<li>pct of category</li>
<li>cumsum</li>
<li>rank</li>
</ul><div class="code">
<pre>
<code>&gt; SELECT state, fruit, avg(x) FROM produce GROUP BY state;
ERROR:  column "produce.fruit" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: SELECT state, fruit, avg(x) FROM produce GROUP BY state;
                      ^

&gt; SELECT state, fruit, avg(x) OVER (PARTITION BY state) FROM produce;
   state    |   fruit    |          avg           
------------+------------+------------------------
 arizona    | banana     | 1.00000000000000000000
 california | orange     |     8.6000000000000000
 california | banana     |     8.6000000000000000
 california | apple      |     8.6000000000000000
 california | banana     |     8.6000000000000000
 california | orange     |     8.6000000000000000
 nevada     | banana     |     6.3333333333333333
 nevada     | apple      |     6.3333333333333333
 nevada     | orange     |     6.3333333333333333
 oregon     | grapefruit |     2.5000000000000000
 oregon     | grapefruit |     2.5000000000000000
 washington | grapefruit |     2.5000000000000000
 washington | apple      |     2.5000000000000000</code>
</pre></div>
<p><a name="where-subquery" id="where-subquery"></a></p>
<h1 id="toc93"><span><a href="#top">WHERE Clause Subqueries</a></span></h1>
<p>Subqueries can be used in a WHERE clause with EXISTS, IN, and the comparison operators: = &lt; &gt; &lt;= &gt;= != (&lt;&gt;).</p>
<p><a name="join" id="join"></a></p>
<h1 id="toc94"><span><a href="#top">JOIN</a></span></h1>
<p>The following two queries are equivalent.</p>
<div class="code">
<pre>
<code>SELECT *
FROM a, b
WHERE a.x = b.x
  AND a.y &gt; 0;</code>
</pre></div>
<div class="code">
<pre>
<code>SELECT *
FROM a
  JOIN b
    ON a.x = b.x
WHERE a.y &gt; 0;</code>
</pre></div>
<p>The latter form is perhaps preferred. The latter separates the join condition from the expression, keeping the expression simpler. Each JOIN clause must have an ON clause, reducing the chance of writing a Cartesian join by accident.</p>
<p>To perform an outer join—LEFT, RIGHT, or FULL—one must use a JOIN clause.</p>
<p>JOINs can be used to replace (NOT) EXISTS with a subquery:</p>
<div class="code">
<pre>
<code>SELECT *
FROM customers c
WHERE NOT EXISTS (
  SELECT customer_id
  FROM orders o
  WHERE c.id = o.customer_id
);</code>
</pre></div>
<div class="code">
<pre>
<code>SELECT c.*
FROM customers c
  LEFT JOIN orders o
    ON c.id = o.customer_id
WHERE o.customer_id is NULL;</code>
</pre></div>
<p><a name="from-subquery" id="from-subquery"></a></p>
<h1 id="toc95"><span><a href="#top">FROM Clause Subqueries</a></span></h1>
<p>Subqueries inside parens can appear in FROM and JOIN clauses. They must be given an alias.</p>
<p><a name="as" id="as"></a></p>
<h1 id="toc96"><span><a href="#top">AS</a></span></h1>
<p>Select list items and tables in FROM and JOIN clauses can be given an alias using AS. If the aliased item is a table or column its previous name is hidden. Use of the AS keyword is optional and can be omitted.</p>
<p><a name="limit-offset" id="limit-offset"></a></p>
<h1 id="toc97"><span><a href="#top">LIMIT and OFFSET</a></span></h1>
<p>The standard is:</p>
<div class="code">
<pre>
<code>OFFSET start { ROW | ROWS }
FETCH { FIRST | NEXT } [ count ] { ROW | ROWS } ONLY</code>
</pre></div>
<p>Of these databases, only PostgreSQL provides a mechanism for selecting the row number, and it requires using a window function: <tt>row_number() OVER ()</tt>.</p>
<p><a name="with" id="with"></a></p>
<h1 id="toc98"><span><a href="#top">WITH</a></span></h1>
<div class="code">
<pre>
<code>CREATE TABLE directed_edge (
  start_node TEXT,
  end_node TEXT
);

INSERT INTO directed_edge VALUES ( 'a', 'b');
INSERT INTO directed_edge VALUES ( 'b', 'c');
INSERT INTO directed_edge VALUES ( 'c', 'd');
INSERT INTO directed_edge VALUES ( 'x', 'y');

WITH RECURSIVE directed_path(start_node, end_node) AS (
  SELECT start_node, end_node
  FROM directed_edge
  UNION
  SELECT dp.start_node, de.end_node
  FROM directed_path AS dp
    JOIN directed_edge de
      ON dp.end_node = de.start_node
)
SELECT *
FROM directed_path;</code>
</pre></div>
<div class="code">
<pre>
<code> start_node | end_node 
------------+----------
 a          | b
 b          | c
 c          | d
 x          | y
 a          | c
 b          | d
 a          | d</code>
</pre></div>
<p><a name="null" id="null"></a></p>
<h1 id="toc99"><span><a href="#top">NULL</a></span></h1>
<p><a href="http://www.sqlite.org/nulls.html">NULL Handling in SQLite Versus Other Database Engines</a></p>
<ul><li>NULL propagates in arithmetic: NULL + 0 is NULL, NULL * 0 is NULL.</li>
<li>NULLs distinct in UNIQUE</li>
<li>NULLs not distinct according to DISTINCT</li>
<li>NULL is FALSE in CASE: "CASE WHEN null THEN 1 ELSE 0 END"</li>
<li>THREE VALUE LOGIC: NULL OR TRUE is TRUE, NULL AND FALSE is FALSE.</li>
</ul><div class="code">
<pre>
<code>-- return 'bar' if foo is NULL
coalesce(foo, 'bar')

-- return NULL if foo is 'bar'
nullif(foo, 'bar')</code>
</pre></div>
<p><a name="set-multiset" id="set-multiset"></a></p>
<h1 id="toc100"><span><a href="#top">Sets and Multisets</a></span></h1>
<div class="code">
<pre>
<code>SELECT 'foo', 3 UNION SELECT 'bar', 7;
SELECT 'foo', 3 INTERSECT SELECT 'bar', 7;
SELECT 'foo', 3 EXCEPT SELECT 'bar', 7;</code>
</pre></div>
<p>ALL and DISTINCT can be used after UNION, INTERSECT, and EXCEPT to indicate multiset or set operations. Set operations (i.e. DISTINCT) are the default.</p>
<p><a name="session-obj" id="session-obj"></a></p>
<h1 id="toc101"><span><a href="#top">Session Objects</a></span></h1>
<p><a name="scripts" id="scripts"></a></p>
<h1 id="toc102"><span><a href="#top">Scripts</a></span></h1>
<p>Temporary tables and variables.</p>
<p><a name="reflection" id="reflection"></a></p>
<h1 id="toc103"><span><a href="#top">Reflection</a></span></h1>
<p>The standard calls for a schema called <tt>INFORMATION_SCHEMA</tt>. The starting point for learning about a database is:</p>
<div class="code">
<pre>
<code>SELECT * FROM INFORMATION_SCHEMA.TABLES;</code>
</pre></div>
<p>The standard also provides these:</p>
<div class="code">
<pre>
<code>&gt; SELECT CURRENT_USER;
&gt; SELECT CURRENT_ROLE;
&gt; SELECT CURRENT_SCHEMA;
&gt; SELECT CURRENT_CATALOG;</code>
</pre></div>
<p><strong>sqlite:</strong></p>
<p>SQLite does not have <tt>INFORMATION_SCHEMA</tt>. Use the <tt>.schema</tt> command to get a list of tables and their DDL.</p>
<p><a name="sargable-expr" id="sargable-expr"></a></p>
<h1 id="toc104"><span><a href="#top">Sargable Expressions</a></span></h1>
<p><a href="http://en.wikipedia.org/wiki/Sargable">Sargable</a> (en.wikipedia.org)</p>
<p><a name="txn" id="txn"></a></p>
<h1 id="toc105"><span><a href="#top">Transactions</a></span></h1>
<p><a name="idempotent" id="idempotent"></a></p>
<h1 id="toc106"><span><a href="#top">Idempotent SQL</a></span></h1>
<p>Idempotent DDL scripts are desirable. <tt>CREATE TABLE</tt> statements fail if the table already exists. Both PostgreSQL and MySQL support <tt>DROP TABLE foo IF EXISTS;</tt> which is not part of the standard.</p>
<p>MERGE (MySQL REPLACE)</p>
<p>TEMP tables and WITH.</p>
<p>Query information_schema. This requires a language which can branch.</p>
<p><a name="postgresql" id="postgresql"></a></p>
<h1 id="toc107"><span><a href="#top">PostgreSQL</a></span></h1>
<ul><li><a href="http://www.postgresql.org/docs/9.1/static/index.html">PostgresSQL 9.1 Documentation</a></li>
</ul><p><a name="mysql" id="mysql"></a></p>
<h1 id="toc108"><span><a href="#top">MySQL</a></span></h1>
<ul><li><a href="http://dev.mysql.com/doc/refman/5.5/en/">MySQL 5.5 Reference Manual</a></li>
<li><a href="https://kb.askmonty.org/en/">MariaDB Knowledge Base</a></li>
</ul><p><a name="sqlite" id="sqlite"></a></p>
<h1 id="toc109"><span><a href="#top">SQLite</a></span></h1>
<ul><li><a href="http://www.sqlite.org/docs.html">SQLite Documentation</a></li>
</ul><p><a name="redis" id="redis"></a></p>
<h1 id="toc110"><span><a href="#top">Redis</a></span></h1>
<ul><li><a href="http://redis.io/documentation">Redis Documentation</a></li>
<li><a href="http://try.redis-db.com/">Try Redis</a></li>
</ul><p><a name="mongodb" id="mongodb"></a></p>
<h1 id="toc111"><span><a href="#top">MongoDB</a></span></h1>
<ul><li><a href="http://www.mongodb.org/display/DOCS/Tutorial">Tutorial</a></li>
<li><a href="http://try.mongodb.org/">Try MongoDB</a></li>
</ul><p><a name="neo4j" id="neo4j"></a></p>
<h1 id="toc112"><span><a href="#top">Neo4j</a></span></h1>
<ul><li><a href="http://docs.neo4j.org/chunked/milestone/index.html">The Neo4j Manual</a></li>
<li><a href="http://www.neo4j.org/learn/try">Try Cypher Online</a></li>
</ul></div>
        </div>
      </div>
      <div id="license-area" class="license-area">
        content of this page licensed under
        <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
        creative commons attribution-sharealike 3.0</a>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17129977-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</body>
</html>
