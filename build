<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html;charset=UTF-8"/>
<link rel="icon" type="image/gif" href="/favicon.gif"/>
<link rel="apple-touch-icon" sizes="120x120" href="touch-icon-iphone-retina.png" />
<link rel="apple-touch-icon" sizes="152x152" href="touch-icon-ipad-retina.png" />
<title>Build Tools: Make, Rake, Ant - Hyperpolyglot</title>
<style type="text/css" id="internal-style">
@import url(hyperpolyglot.css);
</style>
<meta http-equiv="content-type" content="text/html;charset=UTF-8"/>
<meta http-equiv="content-language" content="en"/>
</head>
<body>
<div id="container-wrap-wrap">
  <div id="container-wrap">
    <div id="container">
      <div id="header">
        <h1><a href="/"><span>Hyperpolyglot</span></a></h1>
      </div>
      <div id="content-wrap">
        <div id="main-content">
<div id="page-title">
                            Build Tools: Make, Rake, Ant
                        </div>
<div id="page-content">
                        

<p><a name="top" id="top"></a><a href="#invocation">invocation</a> | <a href="#var">variables</a> | <a href="#var-func">variable functions</a> | <a href="#targets-prerequisites">targets and prerequisites</a> | <a href="#recipes">recipes</a> | <a href="#rules">rules</a> | <a href="#file-dir">files and directories</a><br /><a href="#repo">repositories</a> | <a href="#lib">libraries and namespaces</a> | <a href="#recursion">recursion</a></p>
<table class="wiki-content-table"><tr><th></th>
<th><a href="#make">make</a></th>
<th><a href="#rake">rake</a></th>
<th><a href="#ant">ant</a></th>
</tr><tr><td><a name="version-used" id="version-used"></a><a href="#version-used-note">version used</a><br /><span style="white-space: pre-wrap;"> </span></td>
<td><span style="color: gray"><em>GNU Make 3.81</em></span></td>
<td><span style="color: gray"><em>0.8</em></span></td>
<td><span style="color: gray"><em>Apache Ant 1.8</em></span></td>
</tr><tr><td><a name="show-version" id="show-version"></a><a href="#show-version-note">show version</a><br /><span style="white-space: pre-wrap;"> </span></td>
<td>make <span style="white-space: pre-wrap;">--</span>version</td>
<td>$ rake <span style="white-space: pre-wrap;">--</span>version</td>
<td>ant -version</td>
</tr><tr><td><a name="build-file-name" id="build-file-name"></a><a href="#build-file-name-note">name of build file</a><br /><span style="white-space: pre-wrap;"> </span></td>
<td>Makefile</td>
<td>Rakefile</td>
<td>build.xml</td>
</tr><tr><td><a name="hello-world" id="hello-world"></a><a href="#hello-world-note">hello world</a></td>
<td>$ cat &gt; Makefile<br />
hello:<br /><span style="white-space: pre-wrap;">        </span>@echo Hello, World!<br /><br />
$ make hello</td>
<td>$ cat &gt; Rakefile<br />
task :hello do<br /><span style="white-space: pre-wrap;">  </span>puts "Hello, World!"<br />
end<br /><br />
$ rake hello</td>
<td>$ cat &gt; build.xml<br />
&lt;project&gt;<br /><span style="white-space: pre-wrap;">  </span>&lt;target name="hello"&gt;<br /><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span>&lt;echo&gt;Hello, World!&lt;/echo&gt;<br /><span style="white-space: pre-wrap;">  </span>&lt;/target&gt;<br />
&lt;/project&gt;<br /><br />
$ ant hello</td>
</tr><tr><td><a name="build-hello-world" id="build-hello-world"></a><a href="#build-hello-world-note">build hello world</a></td>
<td>$ cat &gt; Makefile<br />
hello:<br /><span style="white-space: pre-wrap;">        </span>gcc -o $@ $@.c<br /><br />
$ cat &gt; hello.c<br />
#include &lt;stdio.h&gt;<br /><br />
int<br />
main(int argc, char *argv[]) {<br /><span style="white-space: pre-wrap;">  </span>printf("Hello, World!\n");<br />
}<br /><br />
$ make<br /><br />
$ ./hello<br />
Hello, World!</td>
<td>$ cat &gt; Rakefile<br />
task :default =&gt; ["hello"]<br /><br />
file "hello" =&gt; ["hello.c"] do<br /><span style="white-space: pre-wrap;">  </span>sh "gcc -o hello hello.c"<br />
end<br /><br />
$ cat hello.c<br />
#include &lt;stdio.h&gt;<br /><br />
int<br />
main(int argc, char *argv[]) {<br /><span style="white-space: pre-wrap;">  </span>printf("Hello, World!\n");<br />
}<br /><br />
$ rake<br /><br />
$ ./hello<br />
Hello, World!</td>
<td>$ cat &gt; build.xml<br />
&lt;project default="hello"&gt;<br /><span style="white-space: pre-wrap;">  </span>&lt;target name="hello"&gt;<br /><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span>&lt;javac srcdir="."<br /><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;"> </span>includeantruntime="false"<br /><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;"> </span>destdir="."/&gt;<br /><span style="white-space: pre-wrap;">  </span>&lt;/target&gt;<br />
&lt;/project&gt;<br /><br />
$ cat &gt; Hello.java<br />
public class Hello {<br /><span style="white-space: pre-wrap;">  </span>public static void<br /><span style="white-space: pre-wrap;">  </span>main(String[] args) {<br /><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span>String msg = "Hello, World!";<br /><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span>System.out.println(msg);<br /><span style="white-space: pre-wrap;">  </span>}<br />
}<br /><br />
$ ant<br /><br />
$ java Hello<br />
Hello, World!</td>
</tr><tr><td><a name="stmt-separator" id="stmt-separator"></a><a href="#stmt-separator-note">statement separator</a></td>
<td><span style="color: gray"><em>Variable definition terminated by newline unless escaped with a preceding backslash.<br /><br />
Target definition terminated by the first subsequent line without a leading tab.<br /><br />
Within recipes statements are terminated by newline unless escaped with a preceding backslash.</em></span></td>
<td><span style="color: gray"><em>newline or ;<br /><br />
newlines not separators inside (), [], {}, triple quote literals, or after backslash: \</em></span></td>
<td><span style="color: gray"><em>A statement is delimited by an XML start tag and its matching end tag.</em></span></td>
</tr><tr><td><a name="comment" id="comment"></a><a href="#comment-note">comment</a><br /><span style="white-space: pre-wrap;"> </span></td>
<td># <span style="color: gray"><em>comment</em></span></td>
<td># <span style="color: gray"><em>comment</em></span></td>
<td>&lt;!<span style="white-space: pre-wrap;">--</span> <span style="color: gray"><em>comment</em></span> <span style="white-space: pre-wrap;">--</span>&gt;</td>
</tr><tr><th colspan="4"><a name="invocation" id="invocation"></a><a href="#invocation-note">invocation</a></th>
</tr><tr><th></th>
<th>make</th>
<th>rake</th>
<th>ant</th>
</tr><tr><td><a name="specify-build-file" id="specify-build-file"></a><a href="#specify-build-file-note">specify build file</a></td>
<td>$ make -f <span style="color: gray">PATH [TARGET]</span><br />
$ make <span style="white-space: pre-wrap;">--</span>makefile <span style="color: gray">PATH [TARGET]</span></td>
<td>$ rake -f <span style="color: gray">PATH</span> <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span><br />
$ rake <span style="white-space: pre-wrap;">--</span>rakefile <span style="color: gray">PATH</span> <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span></td>
<td>$ ant -f <span style="color: gray">PATH</span> <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span><br />
$ ant -buildfile <span style="color: gray">PATH</span> <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span></td>
</tr><tr><td><a name="dry-run" id="dry-run"></a><a href="#dry-run-note">dry run</a><br /><span style="white-space: pre-wrap;"> </span></td>
<td>$ make -n <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span><br />
$ make <span style="white-space: pre-wrap;">--</span>dry-run <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span></td>
<td>$ rake -n <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span><br />
$ rake <span style="white-space: pre-wrap;">--</span>dry-run <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span></td>
<td><span style="color: gray"><em>none</em></span></td>
</tr><tr><td><a name="keep-going-after-errors" id="keep-going-after-errors"></a><a href="#keep-going-after-errors-note">keep going after errors</a></td>
<td>$ make -k <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span><br />
$ make <span style="white-space: pre-wrap;">--</span>keep-going <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span></td>
<td><span style="color: gray"><em>none</em></span></td>
<td>$ ant -k <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span><br />
$ ant -keep-going <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span></td>
</tr><tr><td><a name="run-jobs-in-parallel" id="run-jobs-in-parallel"></a><a href="#run-jobs-in-parallel-note">run jobs in parallel</a></td>
<td>$ make -j 10 <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span><br />
$ make <span style="white-space: pre-wrap;">--</span>jobs=10 <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span></td>
<td><span style="color: gray"><em>none</em></span></td>
<td><span style="color: gray"><em>none</em></span></td>
</tr><tr><td><a name="list-targets" id="list-targets"></a><a href="#list-targets-note">list targets</a></td>
<td>$ env -i make -nRrp | grep -v '^#'</td>
<td>$ rake -T<br />
$ rake <span style="white-space: pre-wrap;">--</span>tasks</td>
<td>$ ant -p<br />
$ ant -projecthelp</td>
</tr><tr><td><a name="touch-targets" id="touch-targets"></a><a href="#touch-targets-note">touch targets</a></td>
<td>$ make -t <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span><br />
$ make <span style="white-space: pre-wrap;">--</span>touch <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span></td>
<td><span style="color: gray"><em>none</em></span></td>
<td><span style="color: gray"><em>none</em></span></td>
</tr><tr><td><a name="always-rebuild" id="always-rebuild"></a><a href="#always-rebuild-note">always rebuild</a></td>
<td>$ make -B <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span><br />
$ make <span style="white-space: pre-wrap;">--</span>always-make <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span></td>
<td><span style="color: gray"><em>none</em></span></td>
<td><span style="color: gray"><em>none</em></span></td>
</tr><tr><td><a name="up-to-date-test" id="up-to-date-test"></a><a href="#up-to-date-test-note">up-to-date test</a></td>
<td>$ make -q <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span><br />
$ make <span style="white-space: pre-wrap;">--</span>question <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span></td>
<td><span style="color: gray"><em>none</em></span></td>
<td><span style="color: gray"><em>none</em></span></td>
</tr><tr><th colspan="4"><a name="var" id="var"></a><a href="#var-note">variables</a></th>
</tr><tr><th></th>
<th>make</th>
<th>rake</th>
<th>ant</th>
</tr><tr><td><a name="set-use-var" id="set-use-var"></a><a href="#set-use-var-note">set and access variable</a></td>
<td>msg := hello<br /><br />
say_hello:<br /><span style="white-space: pre-wrap;">        </span>@echo $(msg)<br /><br /><span style="color: gray"># alternate syntax:</span><br />
say_hello2:<br /><span style="white-space: pre-wrap;">        </span>@echo ${msg}</td>
<td>msg = "hello"<br /><br />
task :say_hello do<br /><span style="white-space: pre-wrap;">  </span>puts msg<br />
end</td>
<td>&lt;property name="msg" value="hello"/&gt;<br /><br />
&lt;target name="say_hello"&gt;<br /><span style="white-space: pre-wrap;">  </span>&lt;echo&gt;${msg}&lt;/echo&gt;<br />
&lt;/target&gt;</td>
</tr><tr><td><a name="undefined-var" id="undefined-var"></a><a href="#undefined-var-note">undefined variable access</a></td>
<td><span style="color: gray"><em>evaluates as empty string</em></span></td>
<td><span style="color: gray"><em>raises</em> NameError</span></td>
<td><span style="color: gray"><em>no variable name substitution occurs; i.e. the variable name itself with the dollar sign and the braces appear in the string</em></span></td>
</tr><tr><td><a name="redefine-var" id="redefine-var"></a><a href="#redefine-var-note">redefine variable</a></td>
<td><span style="color: gray"><em>last definition overwrites previous definition</em></span></td>
<td><span style="color: gray"><em>last definition overwrites previous definition</em></span></td>
<td><span style="color: gray"><em>later definitions are ignored; use</em> var <em>for a mutable variable</em></span></td>
</tr><tr><td><a name="append-var" id="append-var"></a><a href="#append-var-note">append to variable</a></td>
<td>src_files := foo.c<br /><br /><span style="color: gray"># sets src_files to "foo.c bar.c":</span><br />
src_files += bar.c<br /><br />
src_files:<br /><span style="white-space: pre-wrap;">        </span>echo $(src_files)</td>
<td>src_files = ['foo.c']<br />
src_files <span style="white-space: pre-wrap;">&lt;&lt;</span> 'bar.c'<br /><br />
task :src_files do<br /><span style="white-space: pre-wrap;">  </span>puts src_files.join(' ')<br />
end</td>
<td><span style="color: gray"><em>none</em></span></td>
</tr><tr><td><a name="conditionally-def-var" id="conditionally-def-var"></a><a href="#conditionally-def-var-note">conditionally define variable</a></td>
<td>ifeq ($(ENV),test)<br />
db := test<br />
else<br />
db := prod<br />
endif<br /><br /><span style="color: gray"># also ifneq</span></td>
<td>if ENV["ENV"] == "test"<br /><span style="white-space: pre-wrap;">  </span>db = "test"<br />
else<br /><span style="white-space: pre-wrap;">  </span>db = "prod"<br />
end</td>
<td>&lt;property environment="env"/&gt;<br /><br />
&lt;condition property="db"<br /><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;"> </span>value="test"<br /><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;"> </span>else="prod"&gt;<br /><span style="white-space: pre-wrap;">  </span>&lt;equals arg1="${env.ENV}" arg2="test"/&gt;<br />
&lt;/condition&gt;</td>
</tr><tr><td><a name="env-var" id="env-var"></a><a href="#env-var-note">environment variable</a></td>
<td>invoker := $(USER)</td>
<td>invoker = ENV['USER']</td>
<td>&lt;property environment="env"/&gt;<br /><br />
&lt;property name="invoker"<br /><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span>value="${env.USER}"/&gt;</td>
</tr><tr><td><a name="set-var-if-not-exists" id="set-var-if-not-exists"></a><a href="#set-var-if-not-exists-note">set variable if doesn't exist</a></td>
<td>database ?= dev_db</td>
<td>database = dev_db if database.nil?</td>
<td></td>
</tr><tr><td><a name="error-var-not-set" id="error-var-not-set"></a><a href="#error-var-not-set-note">fatal error if variable not set</a></td>
<td>ifeq ($(PASSWORD),)<br />
$(error PASSWORD not set)<br />
endif</td>
<td>raise "password not set" if password.nil?</td>
<td></td>
</tr><tr><td><a name="warn-var-not-set" id="warn-var-not-set"></a><a href="#warn-var-not-set-note">warn if variable not set</a></td>
<td>ifeq ($(ACCOUNT),)<br />
$(warning ACCOUNT not set; setting to $(USER))<br />
ACCOUNT := $(USER)<br />
endif</td>
<td></td>
<td></td>
</tr><tr><th colspan="4"><a name="var-func" id="var-func"></a><a href="#var-func-note">variable functions</a></th>
</tr><tr><th></th>
<th>make</th>
<th>rake</th>
<th>ant</th>
</tr><tr><td><a name="glob-filenames" id="glob-filenames"></a><a href="#glob-filenames-note">glob filenames</a><br /><span style="white-space: pre-wrap;"> </span></td>
<td>src := $(wildcard *.c)</td>
<td>src = Dir.glob('*.rb')<br /><br /><span style="color: gray"># lazy evaluation:</span><br />
src = FileList.new('*.c')</td>
<td>&lt;fileset id="javaFiles" dir="."&gt;<br /><span style="white-space: pre-wrap;">  </span>&lt;include name="*.java"/&gt;<br />
&lt;/fileset&gt;<br /><br />
&lt;pathconvert pathsep=" "<br /><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;"> </span>property="src"<br /><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;"> </span>refid="javaFiles"/&gt;</td>
</tr><tr><td><a name="recursively-glob-filenames" id="recursively-glob-filenames"></a><a href="#recursively-glob-filenames-note">recursively glob filenames</a></td>
<td>src := $(shell find . -name '*.c')</td>
<td>src = Dir.glob('<span style="white-space: pre-wrap;">**</span>/*.c')<br /><br /><span style="color: gray"># lazy evaluation:</span><br />
src = FileList.new('<span style="white-space: pre-wrap;">**</span>/*.c')</td>
<td></td>
</tr><tr><td><a name="pattern-subst" id="pattern-subst"></a><a href="#pattern-subst-note">pattern substitution</a></td>
<td>obj = $(src: %.c = %.o)<br /><br /><span style="color: gray"># or:</span><br />
obj = $(patsubst %.c,%.o,$(src))</td>
<td>obj = src.sub('\.c$', '.o')</td>
<td></td>
</tr><tr><td><a name="global-subst" id="global-subst"></a><a href="#global-subst-note">global substitution</a></td>
<td>american := meter.txt center.csv<br />
british := $(subst ter,tre,$(american))</td>
<td>american = ['meter.txt', 'center.csv']<br />
british = american.map do |o|<br /><span style="white-space: pre-wrap;">  </span>o.sub(/ter/, 'tre')<br />
end</td>
<td></td>
</tr><tr><td><a name="foreach" id="foreach"></a><a href="#foreach-note">foreach</a></td>
<td>dirs := a b c d<br />
files := $(foreach dir,$(dirs),$(wildcard $(dir)/*))</td>
<td></td>
<td></td>
</tr><tr><td><a name="call" id="call"></a><a href="#call-note">call</a></td>
<td>reverse = $(2) $(1)<br />
foo = $(call reverse,a,b)</td>
<td></td>
<td></td>
</tr><tr><td><a name="shell" id="shell"></a><a href="#shell-note">shell</a></td>
<td>yyyymmdd = $(shell date +'%Y%m%d')</td>
<td>yyyymmdd = <span style="white-space: pre-wrap;">`</span>date +'%Y%m%d'<span style="white-space: pre-wrap;">`</span></td>
<td>&lt;exec executable="date"<br /><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span>outputproperty="yyyymmdd"&gt;<br /><span style="white-space: pre-wrap;">  </span>&lt;arg value="+'%Y%m%d'"/&gt;<br />
&lt;/exec&gt;</td>
</tr><tr><td><a name="dirname-basename" id="dirname-basename"></a><a href="#dirname-basename-note">dirname and basename</a></td>
<td><span style="color: gray"># leaves trailing slash (can operate<br />
# on multiple arguments):</span><br />
$(dir /etc/passwd)<br /><br />
$(notdir /etc/passwd)</td>
<td><span style="color: gray"># no trailing slash:</span><br />
File.dirname("/etc/passwd")<br /><br />
File.basename("/etc/passwd")</td>
<td>&lt;dirname property="file_dir" file="/etc/passwd"/&gt;<br />
&lt;echo&gt;${file_dir}&lt;/echo&gt;<br /><br />
&lt;basename property="file_base" file="/etc/passwd"/&gt;<br />
&lt;echo&gt;${file_base}&lt;/echo&gt;</td>
</tr><tr><td>root and suffix</td>
<td><span style="color: gray"># README</span><br />
$(basename README.txt)<br /><br /><span style="color: gray"># .txt</span><br />
$(suffix README.txt)</td>
<td><span style="white-space: pre-wrap;">"README.txt"[/(\.[^.]+)$/, 1]</span><br /><br /><span style="color: gray"><em>??</em></span></td>
<td></td>
</tr><tr><td>addsuffix<br />
addprefix</td>
<td>ROOTS := foo bar baz<br /><br /><span style="color: gray"># foo.c bar.c baz.c</span><br />
FILES := $(addsuffix .c,$(ROOTS))<br /><br /><span style="color: gray"># /tmp/foo.c /tmp/bar.c /tmp/baz.c</span><br />
PATHS := $(addprefix /tmp/,$(FILES))</td>
<td></td>
<td></td>
</tr><tr><td>join</td>
<td>$(join /etc/,passwd)</td>
<td>File.join("/etc", "passwd")</td>
<td></td>
</tr><tr><td>realpath</td>
<td>realpath_example:<br /><span style="white-space: pre-wrap;">        </span>ln -s /tmp t<br /><span style="white-space: pre-wrap;">        </span>$(realpath t)</td>
<td></td>
<td></td>
</tr><tr><td>abspath</td>
<td>$(abspath ..)</td>
<td>File.expand_path("..")</td>
<td></td>
</tr><tr><td>if</td>
<td>SRC1 := $(wildcard *.cpp)<br />
SRC2 := $(wildcard *.cxx)<br /><span style="color: gray"># non-empty strings are "true":</span><br />
SRC := $(if $(SRC1),$(SRC1),$(SRC2))</td>
<td></td>
<td></td>
</tr><tr><td>and<br />
or</td>
<td><span style="color: gray"># returns last arg if all args<br />
# are non-empty:</span><br />
$(and $(FOO),$(BAR))<br /><br /><span style="color: gray"># return first non-empty arg:</span><br />
$(or $(FOO),$(BAR))</td>
<td></td>
<td></td>
</tr><tr><td>filter, filter-out</td>
<td>FILES := foo.c foo.h bar.c bar.h<br />
HEADERS := $(filter %.h,$(FILES))<br />
OTHERS := $(filter-out %.h,$(FILES))</td>
<td></td>
<td></td>
</tr><tr><td>sort</td>
<td>LIST := foo foo bar<br /><span style="color: gray"># also removes dupes:</span><br />
SORTED := $(sort $(LIST))</td>
<td></td>
<td></td>
</tr><tr><td>strip</td>
<td>EMPTY :=<br />
FOO := $(EMPTY) foo $(EMPTY)<br />
FOO2 := $(strip $(FOO))</td>
<td></td>
<td></td>
</tr><tr><td>words</td>
<td>NAMES := foo bar baz<br /><span style="color: gray"># 3:</span><br />
NAME_COUNT := $(words $(NAMES))</td>
<td></td>
<td></td>
</tr><tr><td>word</td>
<td>NAMES := foo bar baz<br />
FOO := $(word 1,$(NAMES))<br />
BAR := $(word 2,$(NAMES))<br />
BAZ := $(word 3,$(NAMES))</td>
<td></td>
<td></td>
</tr><tr><td>wordlist</td>
<td>NAMES := foo bar baz<br />
FOO_BAR := $(wordlist 1,2,$(NAMES))<br />
BAR_BAZ := $(wordlist 2,3,$(NAMES))<br />
EMPTY := $(worldlist 1,0,$(NAMES))</td>
<td></td>
<td></td>
</tr><tr><td>firstword, lastword</td>
<td>NAMES := foo bar baz<br />
FOO := $(firstword $(NAMES))<br />
BAZ := $(lastword $(NAMES))</td>
<td></td>
<td></td>
</tr><tr><th colspan="4"><a name="targets-prerequisites" id="targets-prerequisites"></a><a href="#targets-prerequisites-note">targets and prerequisites</a></th>
</tr><tr><th></th>
<th>make</th>
<th>rake</th>
<th>ant</th>
</tr><tr><td><a name="file-target" id="file-target"></a><a href="#file-target-note">file target</a></td>
<td>foo:<br /><span style="white-space: pre-wrap;">        </span>touch $@</td>
<td>file :foo do<br /><span style="white-space: pre-wrap;">  </span>touch "foo"<br />
end</td>
<td>&lt;target name="check-foo"&gt;<br /><span style="white-space: pre-wrap;">  </span>&lt;available file="foo" property="foo.present"/&gt;<br />
&lt;/target&gt;<br /><br />
&lt;target name="do-if-foo" depends="check-foo" if="foo.present"&gt;<br /><span style="white-space: pre-wrap;">  </span>FOO<br />
&lt;/target&gt;</td>
</tr><tr><td><a name="file-target-prerequisite" id="file-target-prerequisite"></a><a href="#file-target-prerequisite-note">file target with prerequisites</a></td>
<td>main.o: main.c common.h<br /><span style="white-space: pre-wrap;">        </span>gcc -c -o main.o main.c</td>
<td>file "main.o" =&gt; ["main.c", "common.h"] do<br /><span style="white-space: pre-wrap;">  </span>sh "gcc -c -o main.o main.c"<br />
end</td>
<td></td>
</tr><tr><td><a name="order-only-prerequisite" id="order-only-prerequisite"></a><a href="#order-only-prerequisite-note">order only prerequisite</a></td>
<td>build:<br /><span style="white-space: pre-wrap;">        </span>mkdir -p build<br /><br />
build/output.csv: | build<br /><span style="white-space: pre-wrap;">        </span>generate-output.py &gt; $@</td>
<td>file_create :build do<br /><span style="white-space: pre-wrap;">  </span>mkdir_p "build"<br />
end<br /><br />
file "build/output.csv" =&gt; :build do<br /><span style="white-space: pre-wrap;">  </span>touch "build/output.csv"<br />
end<br /></td>
<td></td>
</tr><tr><td><a name="phony-target" id="phony-target"></a><a href="#phony-target-note">phony target</a></td>
<td>.PHONY: clean<br /><br />
clean:<br /><span style="white-space: pre-wrap;">        </span>-rm *.o</td>
<td>task :clean do<br /><span style="white-space: pre-wrap;">  </span>sh rm *.o<br />
end</td>
<td>&lt;target name="clean"&gt;<br /><span style="white-space: pre-wrap;">  </span>&lt;delete&gt;<br /><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span>&lt;fileset dir="." includes="*.o"/&gt;<br /><span style="white-space: pre-wrap;">  </span>&lt;/delete&gt;<br />
&lt;/target&gt;</td>
</tr><tr><td>prerequisite search path</td>
<td>VPATH := src:lib<br /><br /><span style="color: gray"># will work if foo.c, src/foo.c<br />
# or lib/foo.c exist:</span><br />
foo: foo.c<br /><span style="white-space: pre-wrap;">        </span>gcc -o $@ $&lt;</td>
<td></td>
<td></td>
</tr><tr><td><a name="phony-target-prerequisite" id="phony-target-prerequisite"></a><a href="#phony-target-prerequisite-note">phony target with prerequisites</a></td>
<td></td>
<td></td>
<td></td>
</tr><tr><td><a name="parallelizable-prerequisites" id="parallelizable-prerequisites"></a><a href="#parallelizable-prerequisites-note">phony target with parallelizable prerequisites</a></td>
<td></td>
<td>multitask</td>
<td>&lt;parallel&gt;<span style="white-space: pre-wrap;">...</span>&lt;/parallel&gt;</td>
</tr><tr><td><a name="default-target" id="default-target"></a><a href="#default-target-note">default target</a></td>
<td><span style="color: gray"># if .DEFAULT_GOAL variable is not set the<br />
# first target that does not start<br />
# with a period is executed.</span><br />
.DEFAULT_GOAL := foo</td>
<td><span style="color: gray"># error to invoke Rake without a target when no :default<br />
# task is defined</span><br />
task :default =&gt; [:foo]<br /><br />
task :foo do<br /><span style="white-space: pre-wrap;">  </span>puts "foo"<br />
end</td>
<td><span style="color: gray">&lt;!<span style="white-space: pre-wrap;">--</span> if no target specifed on cmd line<br />
or as a default ant does nothing successfully <span style="white-space: pre-wrap;">--</span>&gt;</span><br />
&lt;project default="foo"&gt;<br /><span style="white-space: pre-wrap;">  </span>&lt;target name="foo"&gt;<br /><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span>&lt;echo&gt;foo&lt;/echo&gt;<br /><span style="white-space: pre-wrap;">  </span>&lt;/target&gt;<br />
&lt;/project&gt;</td>
</tr><tr><td>target with argument</td>
<td>echo.%:<br /><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span>@echo $*</td>
<td></td>
<td></td>
</tr><tr><td>delete target on error</td>
<td>.DELETE_ON_ERROR:</td>
<td></td>
<td></td>
</tr><tr><td>do not delete if intermediate</td>
<td>.SECONDARY</td>
<td></td>
<td></td>
</tr><tr><td>do not delete if interrupted</td>
<td>.PRECIOUS</td>
<td></td>
<td></td>
</tr><tr><td>conditionally define target</td>
<td>all:<br />
ifeq ($(USER), root )<br /><span style="white-space: pre-wrap;">        </span>echo do not run as root<br />
else<br /><span style="white-space: pre-wrap;">        </span>gcc $(SRC_FILES)<br />
endif<br /><br /><span style="color: gray"># also ifneq</span></td>
<td></td>
<td></td>
</tr><tr><th colspan="4"><a name="recipes" id="recipes"></a><a href="#recipes-note">recipes</a></th>
</tr><tr><th></th>
<th>make</th>
<th>rake</th>
<th>ant</th>
</tr><tr><td><a name="shared-recipe" id="shared-recipe"></a><a href="#shared-recipe-note">shared recipe</a></td>
<td><span style="color: gray"># if run as 'make frobnicate', $@ contains<br />
# 'frobnicate'</span><br />
frobnicate twiddle:<br /><span style="white-space: pre-wrap;">        </span>gcc -o $@ $@.c</td>
<td></td>
<td></td>
</tr><tr><td><a name="shared-target" id="shared-target"></a><a href="#shared-target-note">shared target</a></td>
<td>$ cat &gt; Makefile.common<br />
clean::<br /><span style="white-space: pre-wrap;">        </span>-rm -f *.o<br /><br />
$ cat &gt; Makefile<br />
include Makefile.common<br /><br />
clean::<br /><span style="white-space: pre-wrap;">        </span>-rm -f *.pyc<br /><br /><span style="color: gray"># removes .o and .pyc files:</span><br />
$ make clean</td>
<td></td>
<td></td>
</tr><tr><td>multiple target recipe<br /><span style="color: gray"><em>dummy file technique</em></span></td>
<td>foo.tab.cpp foo.tab.hpp: parser<br /><br />
parser: foo.ypp<br /><span style="white-space: pre-wrap;">        </span>bison -d $&lt;<br /><span style="white-space: pre-wrap;">        </span>touch $@</td>
<td></td>
<td></td>
</tr><tr><td><a name="multiline-var" id="multiline-var"></a><a href="#multiline-var-note">multiline variable</a></td>
<td>define SETUP =<br />
echo performing setup<span style="white-space: pre-wrap;">...</span><br />
mkdir -p build<br />
date +'%s' &gt; build/start.timestamp<br />
endef<br /><br />
foo.txt:<br /><span style="white-space: pre-wrap;">        </span>$(SETUP)<br /><span style="white-space: pre-wrap;">        </span>process $@</td>
<td></td>
<td></td>
</tr><tr><td><a name="universal-recipe" id="universal-recipe"></a><a href="#universal-recipe-note">universal recipe</a></td>
<td>%:<br /><span style="white-space: pre-wrap;">        </span>echo target is $@</td>
<td></td>
<td></td>
</tr><tr><td><a name="empty-recipe" id="empty-recipe"></a><a href="#empty-recipe-note">empty recipe</a></td>
<td>nothing: ;</td>
<td>task :nothing</td>
<td>&lt;target name="nothing"&gt;&lt;/target&gt;</td>
</tr><tr><td><a name="invoke-shell" id="invoke-shell"></a><a href="#invoke-shell-note">invoke shell</a></td>
<td>ls_etc:<br /><span style="white-space: pre-wrap;">        </span>ls /etc</td>
<td>task :ls_etc do<br /><span style="white-space: pre-wrap;">  </span>sh "ls /etc"<br />
end</td>
<td>&lt;exec executable="ls"&gt;<br /><span style="white-space: pre-wrap;">  </span>&lt;arg value="/etc/"/&gt;<br />
&lt;/exec&gt;</td>
</tr><tr><td>invoke shell in different directory</td>
<td>ls_etc:<br /><span style="white-space: pre-wrap;">        </span>(cd /etc; ls)</td>
<td></td>
<td>&lt;exec executable="ls" dir="/etc"/&gt;</td>
</tr><tr><td>configure shell</td>
<td>SHELL := /bin/bash<br />
.SHELLFLAGS := -o pipefail</td>
<td></td>
<td></td>
</tr><tr><td>suppress echoing</td>
<td>foo:<br /><span style="white-space: pre-wrap;">        </span>@echo building <span style="white-space: pre-wrap;">$@...</span><br /><span style="white-space: pre-wrap;">        </span>gcc -o $@ $@.c</td>
<td></td>
<td></td>
</tr><tr><td>ignore error</td>
<td>clean:<br /><span style="white-space: pre-wrap;">        </span>-rm *.o</td>
<td></td>
<td></td>
</tr><tr><td>shell variable</td>
<td>identify_invoker:<br /><span style="white-space: pre-wrap;">        </span>echo $$USER</td>
<td></td>
<td></td>
</tr><tr><td>prerequisite variables<br /><span style="color: gray"><em>first, all, newer than target</em></span></td>
<td>$&lt; $^ $?</td>
<td></td>
<td></td>
</tr><tr><td>target variable</td>
<td>$@</td>
<td></td>
<td></td>
</tr><tr><td>shared prefix variable</td>
<td>$*</td>
<td></td>
<td></td>
</tr><tr><td>set variable in recipe</td>
<td>get_date:<br /><span style="white-space: pre-wrap;">        </span>$(eval DATE := $(shell date))<br /><br />
echo_date: get_date<br /><span style="white-space: pre-wrap;">        </span>echo $(DATE)</td>
<td>date = nil<br /><br />
task :get_date do<br /><span style="white-space: pre-wrap;">  </span>date = Time.now<br />
end<br /><br />
task :echo_date =&gt; :get_date do<br /><span style="white-space: pre-wrap;">  </span>puts date<br />
end</td>
<td></td>
</tr><tr><td>prompt user</td>
<td><span style="color: gray"><em>none</em></span></td>
<td></td>
<td>&lt;target name="foo"&gt;<br /><span style="white-space: pre-wrap;">  </span>&lt;input message="Enter foo:" addproperty="foo"/&gt;<br /><span style="white-space: pre-wrap;">  </span>&lt;echo&gt;foo: ${foo}&lt;/echo&gt;<br />
&lt;/target&gt;</td>
</tr><tr><td>fatal error</td>
<td>foo:<br /><span style="white-space: pre-wrap;">        </span>echo foo not implemented<br /><span style="white-space: pre-wrap;">        </span>false</td>
<td></td>
<td>&lt;target name="foo"&gt;<br /><span style="white-space: pre-wrap;">  </span>&lt;fail message="foo not implemented"/&gt;<br />
&lt;/target&gt;</td>
</tr><tr><th colspan="4"><a name="rules" id="rules"></a><a href="#rules-note">rules</a></th>
</tr><tr><th></th>
<th>make</th>
<th>rake</th>
<th>ant</th>
</tr><tr><td>pattern rule</td>
<td>%.o: %.c<br /><span style="white-space: pre-wrap;">        </span>$(CC) -o $@ $&lt;</td>
<td>rule '.o' =&gt; '.c' do |t|<br /><span style="white-space: pre-wrap;">  </span>sh "gcc -c -o #{t.name} #{t.source}"<br />
end</td>
<td></td>
</tr><tr><td>multiple target rule</td>
<td>%.tab.cpp %.tab.hpp: %.ypp<br /><span style="white-space: pre-wrap;">        </span>bison -d $&lt;</td>
<td></td>
<td></td>
</tr><tr><td>built-in rules</td>
<td><span style="color: gray"># make behaves as if the following rules are<br />
# defined:</span><br />
%.o: %.c<br /><span style="white-space: pre-wrap;">        </span>$(CC) $(CPPFLAGS) $(CFLAGS) -c $&lt;</td>
<td></td>
<td></td>
</tr><tr><td>don't use built-in rules</td>
<td>$ make -r <span style="color: gray">[TARGET] <span style="white-space: pre-wrap;">...</span></span></td>
<td></td>
<td></td>
</tr><tr><td>javac</td>
<td></td>
<td></td>
<td>&lt;javac srcdir="${src}" destdir="${build}"/&gt;</td>
</tr><tr><th colspan="4"><a name="file-dir" id="file-dir"></a><a href="#file-dir-note">files and directories</a></th>
</tr><tr><th></th>
<th>make</th>
<th>rake</th>
<th>ant</th>
</tr><tr><td>rm</td>
<td>rm *.o</td>
<td>rm</td>
<td>&lt;delete file="foo"/&gt;</td>
</tr><tr><td>rm -rf</td>
<td>rm -rf build</td>
<td>rm_rf</td>
<td>&lt;delete dir="foo"/&gt;</td>
</tr><tr><td>cp</td>
<td>cp -n bar baz<br />
cp bar baz<br />
cp bar /tmp</td>
<td>cp</td>
<td>&lt;copy file="bar" tofile="baz"/&gt;<br />
&lt;copy file="bar" tofile="baz" overwrite="true"/&gt;<br />
&lt;copy file="bar" todir="/tmp"/&gt;</td>
</tr><tr><td>cp -R</td>
<td>cp -R foodir bardir</td>
<td>cp_r</td>
<td></td>
</tr><tr><td>mv</td>
<td>mv -n bar baz<br />
mv bar baz<br />
mv bar /tmp</td>
<td>mv</td>
<td>&lt;move file="bar" tofile="baz"/&gt;<br />
&lt;move file="bar" tofile="baz" overwrite="true"/&gt;<br />
&lt;move file="bar" todir="/tmp"/&gt;</td>
</tr><tr><td>mkdir</td>
<td>mkdir foodir</td>
<td>mkdir</td>
<td><span style="color: gray"><em>none</em></span></td>
</tr><tr><td>mkdir -p</td>
<td>mkdir -p foo/bar/bazdir</td>
<td>mkdir_p</td>
<td>&lt;mkdir dir="foo/bar/bazdir"/&gt;</td>
</tr><tr><td>ln -s</td>
<td>ln -s foo altfoo</td>
<td>ln_s</td>
<td></td>
</tr><tr><td>rsync</td>
<td>rsync -ur bar/* baz</td>
<td></td>
<td></td>
</tr><tr><td>tar</td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>jar</td>
<td></td>
<td></td>
<td>&lt;jar jarfile="${dist}/lib/MyProject-${DSTAMP}.jar" basedir="${build}"/&gt;</td>
</tr><tr><td>patch</td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>gzip</td>
<td>gzip test.tar</td>
<td></td>
<td>&lt;gzip src="test.tar" destfile="test.tar.gz"/&gt;</td>
</tr><tr><td>gunzip</td>
<td>gunzip test.tar.gz</td>
<td></td>
<td>&lt;gunzip src="test.tar.gz"/&gt;</td>
</tr><tr><td>chmod</td>
<td></td>
<td>chmod</td>
<td></td>
</tr><tr><td>chown</td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>chgrp</td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>mktemp</td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>touch</td>
<td>touch foo</td>
<td>file :foo<br /><span style="white-space: pre-wrap;">  </span>touch :foo<br />
end</td>
<td></td>
</tr><tr><td>wget</td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>file test</td>
<td>test -e</td>
<td></td>
<td>&lt;available&gt;</td>
</tr><tr><td>regular file test</td>
<td>test -f</td>
<td></td>
<td>&lt;available type="file"&gt;</td>
</tr><tr><td>directory test</td>
<td>test -d</td>
<td></td>
<td>&lt;available type="dir"&gt;</td>
</tr><tr><td>readable test</td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>writable test</td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>executable test</td>
<td></td>
<td></td>
<td></td>
</tr><tr><th colspan="4"><a name="repo" id="repo"></a><a href="#repo-note">repositories</a></th>
</tr><tr><th></th>
<th>make</th>
<th>rake</th>
<th>ant</th>
</tr><tr><td>package dependency</td>
<td></td>
<td></td>
<td></td>
</tr><tr><td>set repository</td>
<td></td>
<td></td>
<td></td>
</tr><tr><th colspan="4"><a name="lib" id="lib"></a><a href="#lib-note">libraries and namespaces</a></th>
</tr><tr><th></th>
<th>make</th>
<th>rake</th>
<th>ant</th>
</tr><tr><td><a name="include" id="include"></a><a href="#include-note">include</a></td>
<td>include ./Makefile.common</td>
<td>load './Rakefile.common'</td>
<td>&lt;import file="./common.xml"/&gt;<br /><span style="color: gray"><em>also &lt;include&gt;</em></span></td>
</tr><tr><td>include if exists</td>
<td>-include ./Makefile.optional</td>
<td>rakefile_lib = './Rakefile.optional'<br /><br />
if File.exists? rakefile_lib<br /><span style="white-space: pre-wrap;">  </span>load rakefile_lib<br />
end</td>
<td></td>
</tr><tr><td>namespace</td>
<td><span style="color: gray"><em>none</em></span></td>
<td>$ cat Rakefile<br />
namespace :foo do<br /><span style="white-space: pre-wrap;">  </span>task :bar do<br /><span style="white-space: pre-wrap;">  </span><span style="white-space: pre-wrap;">  </span>puts "foo:bar"<br /><span style="white-space: pre-wrap;">  </span>end<br />
end<br /><br />
task :bar =&gt; ["foo:bar"] do<br /><span style="white-space: pre-wrap;">  </span>puts "bar"<br />
end<br /><br />
$ rake bar<br />
foo:bar<br />
bar<br /><br />
$ rake foo:bar<br />
foo:bar</td>
<td></td>
</tr><tr><th colspan="4"><a name="recursion" id="recursion"></a><a href="#recursion-note">recursion</a></th>
</tr><tr><th></th>
<th>make</th>
<th>rake</th>
<th>ant</th>
</tr><tr><td><a name="recursive-invocation" id="recursive-invocation"></a><a href="#recursive-invocation-note">recursive invocation</a></td>
<td>foo:<br /><span style="white-space: pre-wrap;">        </span>$(MAKE) -C subdir $@</td>
<td></td>
<td></td>
</tr><tr><td>export variable</td>
<td>export foo</td>
<td><span style="color: gray"><em>none</em></span></td>
<td></td>
</tr><tr><td>export all variables</td>
<td>export</td>
<td><span style="color: gray"><em>none</em></span></td>
<td></td>
</tr><tr><td>unexport variable</td>
<td>unexport foo</td>
<td><span style="color: gray"><em>none</em></span></td>
<td></td>
</tr><tr><th><span style="color: #efefef"><span style="white-space: pre-wrap;">_____________</span></span></th>
<th><span style="color: #efefef"><span style="white-space: pre-wrap;">________________________________________</span></span></th>
<th><span style="color: #efefef"><span style="white-space: pre-wrap;">________________________________________</span></span></th>
<th><span style="color: #efefef"><span style="white-space: pre-wrap;">________________________________________</span></span></th>
</tr></table><p><a name="version-used-note" id="version-used-note"></a></p>
<h2 id="toc0"><span><a href="#version-used">version used</a></span></h2>
<p>The version used for this reference sheet.</p>
<p><a name="show-version-note" id="show-version-note"></a></p>
<h2 id="toc1"><span><a href="#show-version">show version</a></span></h2>
<p>How to get the version of the build tool.</p>
<p><a name="build-file-name-note" id="build-file-name-note"></a></p>
<h2 id="toc2"><span><a href="#build-file-name">name of build file</a></span></h2>
<p>The customary name for the build file.</p>
<p><a name="hello-world-note" id="hello-world-note"></a></p>
<h2 id="toc3"><span><a href="#hello-world">hello world</a></span></h2>
<p>How to use the build tool to write to standard out.</p>
<p><a name="build-hello-world-note" id="build-hello-world-note"></a></p>
<h2 id="toc4"><span><a href="#build-hello-world">build hello world</a></span></h2>
<p>How to build an executable which writes to standard out.</p>
<p><a name="stmt-separator-note" id="stmt-separator-note"></a></p>
<h2 id="toc5"><span><a href="#stmt-separator">statement separator</a></span></h2>
<p>How statements are terminated.</p>
<p><a name="comment-note" id="comment-note"></a></p>
<h2 id="toc6"><span><a href="#comment">comment</a></span></h2>
<p>How to put a comment in the build file.</p>
<p><a name="invocation-note" id="invocation-note"></a></p>
<h1 id="toc7"><span><a href="#invocation">Invocation</a></span></h1>
<p><a name="specify-build-file-note" id="specify-build-file-note"></a></p>
<h2 id="toc8"><span><a href="#specify-build-file">specify build file</a></span></h2>
<p>How to use to use a build file other than the default.</p>
<p><a name="dry-run-note" id="dry-run-note"></a></p>
<h2 id="toc9"><span><a href="#dry-run">dry run</a></span></h2>
<p>How to do a dry run. Commands that would be performed to build the target are echoed, but no actions are performed.</p>
<p><a name="keep-going-after-errors-note" id="keep-going-after-errors-note"></a></p>
<h2 id="toc10"><span><a href="#keep-going-after-errors">keep going after errors</a></span></h2>
<p>When multiple targets are specified, how to keep going even if some of the targets fail to build.</p>
<p><a name="run-jobs-in-parallel-note" id="run-jobs-in-parallel-note"></a></p>
<h2 id="toc11"><span><a href="#run-jobs-in-parallel">run jobs in parallel</a></span></h2>
<p>How to run recipes in parallel.</p>
<p><strong>make:</strong></p>
<p><a name="list-targets-note" id="list-targets-note"></a></p>
<h2 id="toc12"><span><a href="#list-targets">list targets</a></span></h2>
<p>List the targets which can be specified on the command line.</p>
<p><strong>make:</strong></p>
<p><a name="touch-targets-note" id="touch-targets-note"></a></p>
<h2 id="toc13"><span><a href="#touch-targets">touch targets</a></span></h2>
<p>How to run <tt>touch</tt> on all targets without building them. This updates the last modified timestamp to the present and creates an empty file if the target does not exist.</p>
<p><a name="always-rebuild-note" id="always-rebuild-note"></a></p>
<h2 id="toc14"><span><a href="#always-rebuild">always rebuild</a></span></h2>
<p>How to rebuild all targets, even if they are already built and up-to-date.</p>
<p><a name="up-to-date-test-note" id="up-to-date-test-note"></a></p>
<h2 id="toc15"><span><a href="#up-to-date-test">up-to-date test</a></span></h2>
<p>How to test whether the targets are up-to-date. Returns a exit status of zero if they are.</p>
<p><a name="var-note" id="var-note"></a></p>
<h1 id="toc16"><span><a href="#var">Variables</a></span></h1>
<p><a name="set-use-var-note" id="set-use-var-note"></a></p>
<h2 id="toc17"><span><a href="#set-use-var">set and access variable</a></span></h2>
<p>How to set a variable; how to use the value stored in a variable.</p>
<p><strong>make</strong></p>
<p>Make variables are implemented as macro substitutions. There is no difference between the <tt>$(foo)</tt> and <tt>${foo}</tt> syntax. There is, however, a difference between using <tt>:=</tt> and <tt>=</tt> to perform variable assignment.</p>
<p><tt>:=</tt> is the <em>immediate assignment</em> operator. It expands variables on the right hand side when the assignment is performed. A variable defined by immediate assignment is called <em>simply expanded</em>. The <em>immediate assignment</em> behaves like assignment in other programming languages.</p>
<p><tt>=</tt> is the <em>deferred assignment</em> operator. It expands variables on the right each time the variable on the left is referenced. A variable defined by deferred assignment is called <em>recursively expanded</em>. Variables can be used on the left side of a deferred assignment before they are defined. If a <tt>$(wilcard …)</tt> or <tt>$(shell …)</tt> function is used on the right side, the value of the variable may be different each time it is referenced. Deferred assignment should perhaps be regarded as a misfeature of the original version of <tt>make</tt>.</p>
<p>The flavor function can be used to determine whether a variable is simple or recursive:</p>
<div class="code">
<pre>
<code>rec = foo
sim := foo

rec sim:
        # echoes "recursive" or "simple":
        @echo $(flavor $@)</code>
</pre></div>
<p>The variable expressions <tt>$(foo)</tt> or <tt>${foo}</tt> can be used on the left side of an assignment. The variables are immediately evaluated to determine the name of the variable being defined.</p>
<p>Whitespace after an assignment operator is trimmed. It is nevertheless possible to set a variable to a space:</p>
<div class="code">
<pre>
<code>empty :=
space := $(empty) $(empty)</code>
</pre></div>
<p><a name="undefined-var-note" id="undefined-var-note"></a></p>
<h2 id="toc18"><span><a href="#undefined-var">undefined variable access</a></span></h2>
<p>What happens when a variable which is undefined is accessed.</p>
<p><a name="redefine-var-note" id="redefine-var-note"></a></p>
<h2 id="toc19"><span><a href="#redefine-var">redefine variable</a></span></h2>
<p>What happens when a variable is redefined.</p>
<p><a name="append-var-note" id="append-var-note"></a></p>
<h2 id="toc20"><span><a href="#append-var">append to variable</a></span></h2>
<p>How to append to variable.</p>
<p><a name="conditionally-def-var-note" id="conditionally-def-var-note"></a></p>
<h2 id="toc21"><span><a href="#conditionally-def-var">conditionally define variable</a></span></h2>
<p>How to conditionally define a variable.</p>
<p><a name="env-var-note" id="env-var-note"></a></p>
<h2 id="toc22"><span><a href="#env-var">environment variable</a></span></h2>
<p>How to access an environment variable.</p>
<p><strong>make:</strong></p>
<p>Every environment variable becomes a <tt>make</tt> variable.</p>
<p>The <tt>origin</tt> function can be used to identify which variables were environment variables.</p>
<p><em>example of the origin function and a list of return values</em></p>
<p><a name="set-var-if-not-exists-note" id="set-var-if-not-exists-note"></a></p>
<h2 id="toc23"><span><a href="#set-var-if-not-exists">set variable if doesn't exist</a></span></h2>
<p>How to set a variable if it is not already defined.</p>
<p><a name="error-var-not-set-note" id="error-var-not-set-note"></a></p>
<h2 id="toc24"><span><a href="#error-var-not-set">raise error if variable not set</a></span></h2>
<p>How to exit before executing any recipes if a variable is not set.</p>
<p><a name="warn-var-not-set-note" id="warn-var-not-set-note"></a></p>
<h2 id="toc25"><span><a href="#warn-var-not-set">warn if variable not set</a></span></h2>
<p>How to write a message to standard error if a variable is not set.</p>
<p><a name="var-func-note" id="var-func-note"></a></p>
<h1 id="toc26"><span><a href="#var-func">Variable Functions</a></span></h1>
<p><a name="glob-filenames-note" id="glob-filenames-note"></a></p>
<h2 id="toc27"><span><a href="#glob-filenames">glob filenames</a></span></h2>
<p>How to match files in a directory using pattern matching.</p>
<p>Shell-style file pattern matching uses <tt>?</tt> to match a single character and <tt>*</tt> to match zero or more characters.</p>
<p><a name="recursively-glob-filenames-note" id="recursively-glob-filenames-note"></a></p>
<h2 id="toc28"><span><a href="#recursively-glob-filenames">recursively glob filenames</a></span></h2>
<p><a name="pattern-subst-note" id="pattern-subst-note"></a></p>
<h2 id="toc29"><span><a href="#pattern-subst">pattern substitution</a></span></h2>
<p><a name="global-subst-note" id="global-subst-note"></a></p>
<h2 id="toc30"><span><a href="#global-subst">global substitution</a></span></h2>
<p><strong>make</strong></p>
<p>The comma is used as an argument separator. If a comma appears in a match pattern or a replacement pattern, one must store the pattern in a variable:</p>
<div class="code">
<pre>
<code>comma := ,
comma_list := foo,bar,baz _
semicolon_list := $(subst $(comma),;,$(comma_liost))</code>
</pre></div>
<p><a name="foreach-note" id="foreach-note"></a></p>
<h2 id="toc31"><span><a href="#foreach">foreach</a></span></h2>
<p><a name="call-note" id="call-note"></a></p>
<h2 id="toc32"><span><a href="#call">call</a></span></h2>
<p><a name="shell-note" id="shell-note"></a></p>
<h2 id="toc33"><span><a href="#shell">shell</a></span></h2>
<p><a name="dirname-basename-note" id="dirname-basename-note"></a></p>
<h2 id="toc34"><span><a href="#dirname-basename">dirname and basename</a></span></h2>
<p><a name="targets-prerequisites-note" id="targets-prerequisites-note"></a></p>
<h1 id="toc35"><span><a href="#targets-prerequisites">Targets and Prerequisites</a></span></h1>
<p><a name="file-target-note" id="file-target-note"></a></p>
<h2 id="toc36"><span><a href="#file-target">file target</a></span></h2>
<p>A target which creates a file. The target should not execute if the file exists and is more recent than its prerequisites.</p>
<p><a name="file-target-prerequisite-note" id="file-target-prerequisite-note"></a></p>
<h2 id="toc37"><span><a href="#file-target-prerequisite">file target with prerequisites</a></span></h2>
<p><a name="order-only-prerequisite-note" id="order-only-prerequisite-note"></a></p>
<h2 id="toc38"><span><a href="#order-only-prerequisite">order only prerequisite</a></span></h2>
<p>How to define a prerequisite which will be built if it does not exist before the target, but will not trigger a re-build of the target if it is newer than the target.</p>
<p>Directories should usually be order only prerequisites, because the last modification timestamp of a directory is updated whenever a file is added to or removed from the directory.</p>
<p><a name="phony-target-note" id="phony-target-note"></a></p>
<h2 id="toc39"><span><a href="#phony-target">phony target</a></span></h2>
<p>A target which always executes, even if a file of the same name exists.</p>
<p><strong>make:</strong></p>
<p>A target can be declared phony by making it a prerequisite for the .PHONY target. This ensures execution of the recipe even if a file with the same name is created in the Makefile directory.</p>
<p>Older versions of Make which don't support .PHONY use the following idiom to ensure execution:</p>
<div class="code">
<pre>
<code>clean: FORCE
        rm $(objects)
FORCE:</code>
</pre></div>
<p><a name="default-target-note" id="default-target-note"></a></p>
<h2 id="toc40"><span><a href="#default-target">default target</a></span></h2>
<p>Which target is executed if the build tool is run without an argument; how to specify the target which is executed if the build tool is run without an argument.</p>
<p><a name="universal-target-note" id="universal-target-note"></a></p>
<h2 id="toc41"><span><a href="#universal-target">universal target</a></span></h2>
<p>How to define a default recipe.</p>
<p><a name="recipes-note" id="recipes-note"></a></p>
<h1 id="toc42"><span><a href="#recipes">Recipes</a></span></h1>
<p><a name="shared-recipe-note" id="shared-recipe-note"></a></p>
<h2 id="toc43"><span><a href="#shared-recipe">shared recipe</a></span></h2>
<p>How to define targets with a common recipe.</p>
<p><a name="shared-target-note" id="shared-target-note"></a></p>
<h2 id="toc44"><span><a href="#shared-target">shared target</a></span></h2>
<p>How to define a target with multiple recipes. If the target is invoked, all recipes are executed.</p>
<p><strong>make:</strong></p>
<p>If a target has multiple recipes, all of them must use the double colon syntax. The recipes are executed in the order in which they are defined in the Makefile.</p>
<p>Each recipe can have its own prerequisites. Recipes for which the the prerequisites exist and the target is newer than the prerequisites will not execute.</p>
<p><a name="empty-recipe-note" id="empty-recipe-note"></a></p>
<h2 id="toc45"><span><a href="#empty-recipe">empty recipe</a></span></h2>
<p><a name="invoke-shell-note" id="invoke-shell-note"></a></p>
<h2 id="toc46"><span><a href="#invoke-shell">invoke shell</a></span></h2>
<p><a name="multiline-var-note" id="multiline-var-note"></a></p>
<h2 id="toc47"><span><a href="#multiline-var">multiline variable</a></span></h2>
<p>How to define a variable containing newlines.</p>
<p><a name="rules-note" id="rules-note"></a></p>
<h1 id="toc48"><span><a href="#rules">Rules</a></span></h1>
<h2 id="toc49"><span>variables used by built-in rules for c</span></h2>
<p>Many of the variables have an accompanying variables for setting flags:</p>
<ul><li>AR: ARFLAGS</li>
<li>AS: ASFLAGS</li>
<li>CC: CFLAGS</li>
<li>CXX: CXXFLAGS</li>
<li>CPP: CPPFLAGS</li>
<li>ld: LDFLAGS</li>
<li>LEX: LFLAGS</li>
<li>YACC: YFLAGS</li>
</ul><p><a name="file-dir-note" id="file-dir-note"></a></p>
<h1 id="toc50"><span><a href="#file-dir">Files and Directories</a></span></h1>
<p><a name="repo-note" id="repo-note"></a></p>
<h1 id="toc51"><span><a href="#repo">Repositories</a></span></h1>
<p><a name="lib-note" id="lib-note"></a></p>
<h1 id="toc52"><span><a href="#lib">Libraries and Namespaces</a></span></h1>
<p><a name="include-note" id="include-note"></a></p>
<h2 id="toc53"><span><a href="#include">include</a></span></h2>
<p><a name="recursion-note" id="recursion-note"></a></p>
<h1 id="toc54"><span><a href="#recursion">Recursion</a></span></h1>
<p><a name="recursive-invocation-note" id="recursive-invocation-note"></a></p>
<h2 id="toc55"><span><a href="#recursive-invocation">recursive invocation</a></span></h2>
<p>How to invoke the build tool on a build file in a subdirectory.</p>
<p><strong>make:</strong></p>
<p>Using <tt>$(MAKE)</tt> instead of <tt>make</tt> guarantees that the same version of <tt>make</tt> is used and passes along command line options from the original invocation.</p>
<p><a name="terminology" id="terminology"></a></p>
<h1 id="toc56"><span><a href="#top">Terminology</a></span></h1>
<ul><li>variable</li>
<li>variable function</li>
<li>target</li>
<li>prerequisite</li>
<li>recipe</li>
<li>build</li>
<li>job</li>
<li>job slot</li>
<li>rule</li>
<li>built-in rule</li>
</ul><p><a name="doc" id="doc"></a><a name="make" id="make"></a></p>
<h1 id="toc57"><span><a href="#top">Make</a></span></h1>
<ul><li><a href="http://www.gnu.org/software/make/manual/make.html">GNU make</a></li>
</ul><p>If precautions are taken it is possible to write a Makefile which will build on a variety of POSIX systems:</p>
<ul><li><a href="http://www.gnu.org/software/autoconf/manual/autoconf.html#Portable-Shell">Portable Shell Programming</a></li>
<li><a href="http://www.gnu.org/software/autoconf/manual/autoconf.html#Portable-Make">Portable Make Programming</a></li>
<li><a href="http://www.gnu.org/software/autoconf/manual/autoconf.html#Portable-C-and-C_002b_002b">Portable C and C++ Programming</a></li>
</ul><p>A Makefile consists of rules which have the following format:</p>
<div class="code">
<pre>
<code>TARGET ... : PREREQUISITE ...
        ACTION
        ...</code>
</pre></div>
<p>The rule consists of usually one target, zero or more prerequisites, and zero or more actions. The actions are collectively called the recipe for the rule.</p>
<p>When multiple targets are provides the effect is the same as defining separate rules (one for each target) with the same prerequisites and actions. The targets are not necessarily synonyms since the actions can inspect the $@ variable to get the target name.</p>
<p>When the target is invoked, <tt>make</tt> will first execute any of the prerequisites which can be defined using rules. If <tt>make</tt> cannot find a rule for a prerequisite it will exit with an error. Then <tt>make</tt> will execute the recipe.</p>
<p>The actions of a recipe are a sequence of lines, each starting with a tab character and containing a shell expression. If the last character on an action line is a backslash \, then the action continues on the following line. <tt>make</tt> will interpret any makefile variables in the action and then fork a shell to execute the shell expression. Makefile variables start with a dollar sign. Use duplication to pass a dollar sign character to the shell. Make echoes the action before executing it, but this can be suppressed by putting an ampersand after the tab character.</p>
<p>Here is an example of defining and using a Makefile variable:</p>
<div class="code">
<pre>
<code>hello = Hello, World!

hello :
        @echo $(hello)</code>
</pre></div>
<p>There is target with the same name as the variable. Targets and variables live in separate namespaces so there is no conflict.</p>
<p>Here is an example of how to define a suffix rule. In the recipe <tt>$@</tt> refers to the target and <tt>$&lt;</tt> refers to the dependency.</p>
<div class="code">
<pre>
<code>%.html: %.md
        markdown $&lt; &gt; $@</code>
</pre></div>
<ul><li><em>files with the same name as targets, .PHONY</em></li>
<li><em>invoking make, default rule</em></li>
</ul><p><a name="rake" id="rake"></a></p>
<h1 id="toc58"><span><a href="#top">Rake</a></span></h1>
<p><a href="http://rake.rubyforge.org/">rake.rubyforge.org</a></p>
<p><a name="ant" id="ant"></a></p>
<h1 id="toc59"><span><a href="#top">Ant</a></span></h1>
<p><a href="http://ant.apache.org/manual/index.html">Apache Ant Manual</a></p>

                    </div>
        </div>
      </div>
      <div id="license-area" class="license-area">
        content of this page licensed under
        <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
        creative commons attribution-sharealike 3.0</a>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17129977-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</body>
</html>
